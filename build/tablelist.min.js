function tablelist(e,t){window.TL_ENV=e,window.TL_CLIENT=t}angular.module("tl",["ngResource"]).provider("TablelistSdk",function(){function e(e){var t=a[e];if(!t)throw new Error("Enviroment : "+e+" is not valid");c.ENV=e,c.ENV_DEV="development"==e,c.ENV_PROD="production"==e,c.ENV_LOCAL="local"==e,c.ENV_TEST="test"==e,c.API=t}function t(e){c.SUB_CLIENT=e}function r(e){c.useAuthHeader=e||!1}var o=window.TL_ENV||"production",n=window.TL_CLIENT||"web",i="development"==o,u="production"==o,s="local"==o,l="test"==o,a={production:"https://api.tablelist.com",development:"https://api-dev.tablelist.com",local:"http://localhost:3000",test:"https://api-dev.tablelist.com"},c={ENV:o,CLIENT:n,SUB_CLIENT:null,ENV_DEV:i,ENV_PROD:u,ENV_LOCAL:s,ENV_TEST:l,API:a[o],useAuthHeader:!1,setSubclient:t};return{setEnv:e,setSubclient:t,setUseAuthHeader:r,$get:function(){return c}}}).service("tl.config",["TablelistSdk",function(e){return e}]),angular.module("tl").factory("tl.resource",["$resource","tl.http",function(e,t){function r(e){return t.apiUrl(e)}function o(e){return e}function n(e){for(var t=i(),o=Object.keys(e),n=0;n<o.length;n++){var u=o[n];t[u]=e[u]}for(var s=Object.keys(t),n=0;n<s.length;n++){var u=s[n],l=t[u];l.url&&(l.url=r(l.url))}return t}function i(e){return{update:{method:"PUT",url:e},listImages:{method:"GET",url:e+"/image",isArray:!0},addImage:{method:"POST",url:e+"/image",isArray:!0},deleteImage:{method:"DELETE",url:e+"/image/:imageId",isArray:!0},setPrimaryImage:{method:"PUT",url:e+"/image/:imageId",isArray:!0}}}function u(t,r,o,n){var i=e(r,o,n);return i.ENDPOINT=t,i.URL=r,i}return function(e,t,i){var s=r(e),l=o(t),a=n(i);return u(e,s,l,a)}}]),angular.module("tl").factory("tl.service",["tl.http",function(){"use strict";var e=function(e){this.resource=e},t=function(t){for(var r=function(){e.call(this,t)},o=e.prototype,n=Object.keys(o),i=0;i<n.length;i++){var u=n[i];"constructor"!=u&&(r.prototype[u]=o[u])}return r},r=100,o="-created";return e.prototype.create=function(e,t,r){return this.resource.save({},e,t,r)},e.prototype.read=function(e,t,r){return this.resource.get({id:e},t,r)},e.prototype.update=function(e,t,r,o){return this.resource.update({id:e},t,r,o)},e.prototype.delete=function(e,t,r){return this.resource.delete({id:e},t,r)},e.prototype.list=function(e,t,n,i){return this.resource.query({sort:t||o,limit:e||r},n,i)},e.prototype.query=function(e,t,n,i,u){var s=this.buildQueryString(e);return s?this.resource.query({query:s,sort:n||o,limit:t||r},i,u):null},e.prototype.totals=function(e,t,r,n){var i=this.buildQueryString(e);return i?this.resource.query({total:!0,query:i,sort:t||o},r,n):null},e.prototype.buildQueryString=function(e){try{return JSON.stringify(e)}catch(t){return null}},e.prototype.listImages=function(e,t,r){return this.resource.listImages({id:e},t,r)},e.prototype.addImage=function(e,t,r,o){return t.id=e,this.resource.addImage(t,r,o)},e.prototype.deleteImage=function(e,t,r,o){return this.resource.deleteImage({id:e,imageId:t},r,o)},e.prototype.setPrimaryImage=function(e,t,r,o){return this.resource.setPrimaryImage({id:e,imageId:t},r,o)},{extend:t,common:e}}]),angular.module("tl").factory("tl.cookie",["tl.config","tl.storage",function(e,t){var r=window.location.hostname.indexOf("tablelist.com")<0,o=".tablelist.com",n=function(){};return n.prototype.get=function(e){if(r){var o=t.get(e);return o?o.cookie:null}return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},n.prototype.set=function(n,i,u,s,l,a){if(!i)return this.remove(n,s,l);if(r)return t.set(n,{cookie:i});if(!n||/^(?:expires|max\-age|path|domain|secure)$/i.test(n))return!1;s||(s="/"),u||(u=1/0),l||(l=o),e.ENV_PROD&&(a=!0);var c="";if(u)switch(u.constructor){case Number:c=1/0===u?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+u;break;case String:c="; expires="+u;break;case Date:c="; expires="+u.toUTCString()}var d=encodeURIComponent(n)+"="+encodeURIComponent(i)+c+(l?"; domain="+l:"")+(s?"; path="+s:"")+(a?"; secure":"");return document.cookie=d,!0},n.prototype.remove=function(e,n,i){return i||(i=o),r?t.remove(e):e&&this.exists(e)?(document.cookie=encodeURIComponent(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(i?"; domain="+i:"")+(n?"; path="+n:""),!0):!1},n.prototype.exists=function(e){return r?t.exists(e):new RegExp("(?:^|;\\s*)"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)},new n}]),angular.module("tl").factory("tl.ee",["$rootScope",function(e){var t=function(){};return t.prototype.on=function(t,r){return e.$on(t,r)},t.prototype.emit=function(t,r,o,n){return e.$emit(t,r,o,n)},new t}]),angular.module("tl").factory("tl.facebook",["tl.config",function(){var e=["public_profile","email","user_friends"],t=function(){};return t.prototype.login=function(t){FB.login(function(e){if(e&&e.authResponse){var r=e.authResponse.accessToken;t(null,r)}else t(e)},{scope:e})},new t}]),angular.module("tl").factory("tlHTTPInterceptor",["tl.config","tl.keychain",function(e,t){"use strict";return{request:function(r){r.headers=r.headers||{};var o=t.authToken(),n=r.url.indexOf(e.API)>=0,i=r.url.indexOf("?")>=0;if(n&&!i&&(r.url=r.url+="?"),n&&o&&(e.useAuthHeader?r.headers["x-access-token"]=o:r.url=r.url+"&auth="+o),n&&!o){var u=t.prospectToken();r.url=r.url+"&prospect="+u}if(n&&e.CLIENT){var s=e.CLIENT,l=e.SUB_CLIENT;l&&(s=s+"-"+l),r.url=r.url+"&client="+s}if(n&&e.VERSION){var a=e.VERSION;r.url=r.url+"&version="+a}return r.url=r.url.replace("?&","?"),r}}}]).config(["$httpProvider",function(e){e.interceptors.push("tlHTTPInterceptor")}]).factory("tl.http",["$http","tl.keychain","tl.config",function(e,t,r){var o=function(){};return o.prototype.get=function(t,r){return e.get(this.apiUrl(t,r))},o.prototype.post=function(t,r,o){return e.post(this.apiUrl(t),r,o)},o.prototype.put=function(t,r,o){return e.put(this.apiUrl(t),r,o)},o.prototype.delete=function(t,r){return e.delete(this.apiUrl(t,r))},o.prototype.upload=function(t,r,o){return e.post(this.apiUrl(t,r),o,{headers:{"Content-Type":void 0},transformRequest:angular.identity})},o.prototype.apiUrl=function(e,t){t=t||{},"/"!=e.slice(0,1)&&(e="/"+e);for(var o=[],n=Object.keys(t),i=0;i<n.length;i++){var u=n[i],s=t[u],l=encodeURIComponent(u)+"="+encodeURIComponent(s);o.push(l)}var a=r.API+e;return o.length>0&&(a+="?"+o.join("&")),a},new o}]),angular.module("tl").factory("tl.keychain",["tl.cookie","tl.utils","tl.config",function(e,t,r){"use strict";var o=r.ENV_PROD?"":"_dev",n="tl_auth"+o,i="tl_prospect"+o,u=function(){};return u.prototype.authToken=function(){return e.get(n)},u.prototype.setAuthToken=function(t){return e.set(n,t)},u.prototype.prospectToken=function(){var r=e.get(i);return r||(r=t.guid(16,"-"),this.setProspectToken(r)),r},u.prototype.setProspectToken=function(t){return e.set(i,t)},new u}]),angular.module("tl").factory("tl.query",["tl.config","$location",function(e,t){var r=function(){};return r.prototype.params=function(){return t.search()||{}},r.prototype.subdomain=function(){return window.location.hostname.split(".")[0]},r.prototype.get=function(e){return this.params()[e]},r.prototype.set=function(e,r){var o=this.params();o[e]=r,t.search(o)},new r}]),angular.module("tl").factory("tl.session",["tl.config",function(){var e=function(){};return e.prototype.get=function(e){try{var t=sessionStorage.getItem(e);return JSON.parse(t)}catch(r){return null}},e.prototype.set=function(e,t){if(t)try{var r=JSON.stringify(t);return sessionStorage.setItem(e,r)}catch(o){return null}else this.remove(e)},e.prototype.remove=function(e){return sessionStorage.removeItem(e)},e.prototype.exists=function(e){return null!=this.get(e)},e.prototype.clear=function(){return sessionStorage.clear()},new e}]),angular.module("tl").factory("tl.storage",["tl.config",function(){"use strcit";var e=function(){};return e.prototype.get=function(e){try{var t=localStorage.getItem(e);return JSON.parse(t)}catch(r){return null}},e.prototype.set=function(e,t){if(t)try{var r=JSON.stringify(t);return localStorage.setItem(e,r)}catch(o){return null}else this.remove(e)},e.prototype.remove=function(e){return localStorage.removeItem(e)},e.prototype.exists=function(e){return null!=this.get(e)},e.prototype.clear=function(){return localStorage.clear()},new e}]),angular.module("tl").factory("tl.utils",[function(){var e=function(){};return e.prototype.noop=function(){},e.prototype.slugify=function(e){return e.trim().replace(/\s/gi,"-").replace(/('|\.)/gi,"").toLowerCase()},e.prototype.guid=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},new e}]),angular.module("tl").factory("tl.ws",["tl.config","tl.http","tl.keychain",function(e,t,r){var o=50;return function(e,n,i){var u=this,s=[],l=null,a="ping",c="pong";this.endpoint=e,this.events=function(){return s},this.isConnected=function(){return l&&1==l.readyState},this.socket=function(){return l},this.connect=function(){l&&(this.disconnect(),l=null),l=new WebSocket(this.wsUrl(e));var t=0;l.onopen=function(){t=setInterval(function(){l.send(a)},5e3)},l.onmessage=function(e){if(e.data!==c)try{var t=JSON.parse(e.data);s.unshift(t),s.length>o&&(s.pop(),console.log("removed event: "+s.length)),n&&n(t,s)}catch(r){console.log("Failed to parse data from socket:"),console.log(r)}},l.onclose=function(){clearInterval(t),setTimeout(function(){u.connect()},1e3)},l.onerror=function(e){i&&i(e)}},this.disconnect=function(){this.isConnected()&&l.close()},this.wsUrl=function(e){return t.apiUrl(e).replace("http","ws")+"?auth="+r.authToken()}}}]),angular.module("tl").service("tl.ambassador ",["tl.ambassador.resource","tl.ambassador.service",function(e,t){this.resource=e,this.service=t}]),angular.module("tl").factory("tl.ambassador.resource",["tl.resource",function(e){var t="/ambassador";return e(t,{id:"@id"},{getAll:{method:"GET",url:"ambassador",isArray:!0}})}]),angular.module("tl").service("tl.ambassador.service",["tl.service","tl.ambassador.resource",function(e,t){var r=e.extend(t);return r.prototype.getAll=function(){return t.getAll()},new r}]),angular.module("tl").service("tl.answer",["tl.answer.resource","tl.answer.service",function(e,t){this.resource=e,this.service=t}]),angular.module("tl").factory("tl.answer.resource",["tl.resource",function(e){var t="/answer";return e(t,{},{})}]),angular.module("tl").service("tl.answer.service",["tl.service","tl.answer.resource",function(e,t){var r=e.extend(t);return new r}]),angular.module("tl").service("tl.auth",["tl.auth.resource","tl.auth.service",function(e,t){this.resource=e,this.service=t}]),angular.module("tl").factory("tl.auth.resource",["tl.resource",function(e){var t="/auth";return e(t,{},{register:{method:"POST",url:t+"/register",isArray:!1},login:{method:"POST",url:t+"/login",isArray:!1},loginFacebook:{method:"POST",url:t+"/facebook",isArray:!1},forgotPassword:{method:"POST",url:t+"/forgot",isArray:!1},resetPassword:{method:"POST",url:t+"/reset",isArray:!1}})}]),angular.module("tl").service("tl.auth.service",["tl.auth.resource","tl.keychain","tl.user.service","tl.facebook",function(e,t,r,o){"use strict";var n=function(){};return n.prototype.authToken=function(){return t.authToken()},n.prototype.setAuthToken=function(e){return t.setAuthToken(e)},n.prototype.register=function(t,o,n,i,u,s,l){s=s||function(){};var a=this;return e.register({},{email:t,password:o,firstName:n,lastName:i,promo:u}).$promise.then(function(e){a.setAuthToken(e.token),r.setCurrentUser(e.user),s(e)},l)},n.prototype.login=function(t,o,n,i){n=n||function(){};var u=this;return e.login({},{email:t,password:o}).$promise.then(function(e){u.setAuthToken(e.token),r.setCurrentUser(e.user),n(e)},i)},n.prototype.loginWithFacebook=function(t,n){t=t||function(){};var i=this;o.login(function(o,u){return e.loginFacebook({},{facebookToken:u}).$promise.then(function(e){i.setAuthToken(e.token),r.setCurrentUser(e.user),t(e)},n)})},n.prototype.logout=function(){return this.setAuthToken(null),r.setCurrentUser(null),!0},n.prototype.forgotPassword=function(t,r,o){return e.forgotPassword({},{email:t},r,o)},n.prototype.resetPassword=function(t,r,o,n){return e.resetPassword({},{resetToken:t,password:r},o,n)},new n}]),angular.module("tl").service("tl.booking",["tl.booking.resource","tl.booking.service",function(e,t){this.resource=e,this.service=t}]),angular.module("tl").factory("tl.booking.resource",["tl.resource",function(e){var t="/booking/:id";return e(t,{id:"@id"},{create:{method:"POST",url:"booking"},"void":{method:"POST",url:t+"/void"},refund:{method:"POST",url:t+"/refund"},join:{method:"POST",url:"booking/join"},accept:{method:"POST",url:t+"/accept"},updateBookingUser:{method:"PUT",url:t+"/users/:userId/"},readOutgoingPayment:{method:"GET",url:t+"/outgoing-payment"}})}]),angular.module("tl").service("tl.booking.service",["tl.booking.resource","tl.service",function(e,t){var r=t.extend(e);return r.prototype.create=function(t,r,o){return e.create({},t,r,o)},r.prototype.void=function(t,r,o,n){return e.void({},{id:t,notify:r?!0:!1},o,n)},r.prototype.refund=function(t,r,o,n,i){return e.refund({},{id:t,money:r,reason:o},n,i)},r.prototype.join=function(t,r,o){return e.join({},{splitCode:t},r,o)},r.prototype.accept=function(t,r,o){return e.accept({},{id:t},r,o)},r.prototype.updateBookingUser=function(t,r,o,n,i){return e.updateBookingUser({id:t,userId:r},o,n,i)},r.prototype.readOutgoingPayment=function(t,r,o){return e.readOutgoingPayment({id:t},r,o)},new r}]),angular.module("tl").service("tl.campaign",["tl.campaign.resource","tl.campaign.service",function(e,t){this.resource=e,this.service=t}]),angular.module("tl").factory("tl.campaign.resource",["tl.resource",function(e){var t="/campaign/:id";return e(t,{id:"@id"},{})}]),angular.module("tl").service("tl.campaign.service",["tl.storage","tl.campaign.resource","tl.service",function(e,t,r){var o=r.extend(User);return o.prototype.listInternal=function(){return t.list({internal:!0}).$promise},new o}]),angular.module("tl").service("tl.event",["tl.event.resource","tl.event.service",function(e,t){this.resource=e,this.service=t}]),angular.module("tl").factory("tl.event.resource",["tl.resource",function(e){var t="/event/:id";return e(t,{id:"@id",imageId:"@imageId"},{listForCity:{method:"GET",url:"/city/:cityId/event",isArray:!0},addStaff:{method:"POST",url:t+"/staff",isArray:!1},updateStaff:{method:"PUT",url:t+"/staff/:staffId",isArray:!1},deleteStaff:{method:"DELETE",url:t+"/staff/:staffId",isArray:!1}})}]),angular.module("tl").service("tl.event.service",["tl.service","tl.event.resource",function(e,t){var r=e.extend(t);return r.prototype.listForCity=function(e,r,o){return t.listForCity({cityId:e},r,o)},r.prototype.listCityTonight=function(e,r,o){return t.listCityTonight({cityId:e},r,o)},r.prototype.addStaff=function(e,r,o,n){return t.addStaff({id:e},{userId:r},o,n)},r.prototype.updateStaff=function(e,r,o,n,i){return t.updateStaff({id:e,staffId:r},o,n,i)},r.prototype.deleteStaff=function(e,r,o,n){return t.deleteStaff({id:e,staffId:r},o,n)},new r}]),angular.module("tl").service("tl.city",["tl.city.resource","tl.city.service",function(e,t){this.resource=e,this.service=t}]),angular.module("tl").factory("tl.city.resource",["tl.resource",function(e){return e("/city/:id",{id:"@id"},{})}]),angular.module("tl").service("tl.city.service",["tl.service","tl.city.resource",function(e,t){var r=e.extend(t);return new r}]),angular.module("tl").service("tl.image",["tl.image.resource","tl.image.service",function(e,t){this.resource=e,this.service=t}]),angular.module("tl").factory("tl.image.resource",["tl.resource",function(e){var t="/image";return e(t,{},{})}]),angular.module("tl").service("tl.image.service",["tl.service","tl.image.resource","tl.http","$q",function(e,t,r,o){var n=e.extend(t);return n.prototype.upload=function(e){var t=o.defer(),n=new FormData;n.append("image",e);var i=4e6;return e.size>i&&t.reject("File cannot be greater than 4mb"),r.upload("/image",{size:"smallSquare"},n).success(function(e,r,o,n){t.resolve(e,r,o,n)}).error(function(e,r,o,n){t.reject(e,r,o,n)}),t.promise},new n}]),angular.module("tl").service("tl.inquiry",["tl.inquiry.resource","tl.inquiry.service",function(e,t){this.resource=e,this.service=t}]),angular.module("tl").factory("tl.inquiry.resource",["tl.resource",function(e){var t="/inquiry/:id";return e(t,{id:"@id"},{})}]),angular.module("tl").service("tl.inquiry.service",["tl.service","tl.inquiry.resource",function(e,t){var r=e.extend(t);return new r}]),angular.module("tl").service("tl.inventory",["tl.inventory.resource","tl.inventory.service",function(e,t){this.resource=e,this.service=t}]),angular.module("tl").factory("tl.inventory.resource",["tl.resource",function(e){var t="/inventory/:id";return e(t,{id:"@id"},{})}]),angular.module("tl").service("tl.inventory.service",["tl.service","tl.inventory.resource",function(e,t){var r=e.extend(t);return new r}]),angular.module("tl").service("tl.invoice",["tl.invoice.resource","tl.invoice.service",function(e,t){this.resource=e,this.service=t}]),angular.module("tl").factory("tl.invoice.resource",["tl.resource",function(e){var t="/invoice/:id";return e(t,{id:"@id"},{update:{method:"PUT",url:t,isArray:!1},readPdf:{method:"GET",url:t+"/pdf",isArray:!1},createPdf:{method:"POST",url:t+"/pdf",isArray:!1}})}]),angular.module("tl").service("tl.invoice.service",["tl.service","tl.invoice.resource",function(e,t){var r=e.extend(t);return r.prototype.readPdf=function(e){return t.readPdf({id:e})},r.prototype.createPdf=function(e){return t.createPdf({id:e})},new r}]),angular.module("tl").service("tl.item",["tl.item.resource","tl.item.service",function(e,t){this.resource=e,this.service=t}]),angular.module("tl").factory("tl.item.resource",["tl.resource",function(e){var t="/item/:id";return e(t,{id:"@id"},{})}]),angular.module("tl").service("tl.item.service",["tl.service","tl.item.resource",function(e,t){var r=e.extend(t);return new r}]),angular.module("tl").service("tl.promo",["tl.promo.resource","tl.promo.service",function(e,t){this.resource=e,this.service=t}]),angular.module("tl").factory("tl.promo.resource",["tl.resource",function(e){var t="/promo/:id";return e(t,{id:"@id"},{redeem:{method:"POST",url:"/promo/redeem"}})}]),function(){"use strict";angular.module("tl").service("tl.promo.service",["tl.storage","tl.promo.resource","tl.service",function(e,t,r){var o=r.extend(t);return o.prototype.redeem=function(e){return t.redeem({code:e})},new o}])}(),angular.module("tl").service("tl.payment",["tl.payment.resource","tl.payment.service",function(e,t){this.resource=e,this.service=t}]),angular.module("tl").factory("tl.payment.resource",["tl.resource",function(e){var t="/paymentProfile/:id";return e(t,{id:"@id"},{})}]),angular.module("tl").service("tl.payment.service",["tl.service","tl.payment.resource",function(e,t){"use strict";var r=e.extend(t);return r.prototype.addProfile=function(e,t,r,o,n,i,u,s,l,a,c){var d={cardholderName:e,cardNumber:t,cardExpMonth:r,cardExpYear:o,cardCvv:n,cardZip:l,address:{address:i,city:u,state:s}};return this.create(d,a,c)},r.prototype.updateProfile=function(e,t,r,o,n,i,u,s,l,a,c,d){if(!e)return this.addProfile(t,r,o,n,i,u,s,l,a,c,d);var f={cardholderName:t,cardNumber:r,cardExpMonth:o,cardExpYear:n,cardCvv:i,cardZip:a,address:{address:u,city:s,state:l}};return this.update(e,f,c,d)},new r}]),angular.module("tl").service("tl.prospect",["tl.prospect.resource","tl.prospect.service",function(e,t){this.resource=e,this.service=t}]),angular.module("tl").factory("tl.prospect.resource",["tl.resource",function(e){var t="/prospect/:id";return e(t,{id:"@id"},{})}]),angular.module("tl").service("tl.prospect.service",["tl.service","tl.prospect.resource",function(e,t){var r=e.extend(t);return r.prototype.updateProspect=function(e,r,o){return delete e._id,delete e.id,t.update({},e,r,o)},new r}]),angular.module("tl").service("tl.question",["tl.question.resource","tl.question.service",function(e,t){this.resource=e,this.service=t}]),angular.module("tl").factory("tl.question.resource",["tl.resource",function(e){var t="/question";return e(t,{id:"@id"},{get:{method:"GET",url:t+"/:id"},listAnswers:{method:"GET",url:t+"/:id/answers",isArray:!0},listTotalsForAnswers:{method:"GET",url:t+"/:id/answers/totals",isArray:!0}})}]),angular.module("tl").service("tl.question.service",["tl.question.resource","tl.service",function(e,t){var r=t.extend(e);return r.prototype.listAnswers=function(t){return e.listAnswers({id:t})},r.prototype.listTotalsForAnswers=function(t){return e.listTotalsForAnswers({id:t})},new r}]),angular.module("tl").service("tl.report",["tl.report.resource","tl.report.service",function(e,t){this.resource=e,this.service=t}]),angular.module("tl").factory("tl.report.resource",["tl.resource",function(e){var t="/report/:id";return e(t,{id:"@id"},{reports:{method:"GET",url:"/report/types"},download:{method:"GET",url:t+"/download"}})}]),angular.module("tl").service("tl.report.service",["tl.service","tl.report.resource",function(e,t){var r=e.extend(t);return r.prototype.reports=function(e,r){return t.reports({},e,r)},r.prototype.listReports=function(e,r,o){return t.query({report:e},r,o)},r.prototype.download=function(e,r,o){return t.download({id:e},r,o)},new r}]),angular.module("tl").service("tl.review",["tl.review.resource","tl.review.service",function(e,t){this.resource=e,this.service=t}]),angular.module("tl").factory("tl.review.resource",["tl.resource",function(e){var t="/review/:id";return e(t,{id:"@id"},{})}]),angular.module("tl").service("tl.review.service",["tl.service","tl.review.resource",function(e,t){var r=e.extend(t);return new r}]),angular.module("tl").service("tl.reward",["tl.reward.resource","tl.reward.service",function(e,t){this.resource=e,this.service=t}]),angular.module("tl").factory("tl.reward.resource",["tl.resource",function(e){var t="/reward/:id";return e(t,{id:"@id"},{})}]),angular.module("tl").service("tl.reward.service",["tl.service","tl.reward.resource",function(e,t){var r=e.extend(t);return new r}]),angular.module("tl").service("tl.schedule",["tl.schedule.resource","tl.schedule.service",function(e,t){this.resource=e,this.service=t}]),angular.module("tl").factory("tl.schedule.resource",["tl.resource",function(e){var t="/schedule/:id";return e(t,{id:"@id"},{})}]),angular.module("tl").service("tl.schedule.service",["tl.service","tl.schedule.resource",function(e,t){var r=e.extend(t);return new r}]),angular.module("tl").service("tl.settings",["tl.settings.resource","tl.settings.service",function(e,t){this.resource=e,this.service=t}]),angular.module("tl").factory("tl.settings.resource",["tl.resource",function(e){var t="/config";return e(t,{},{status:{method:"GET",url:"/status",isArray:!1},config:{method:"GET",url:"/config",isArray:!1}})}]),angular.module("tl").service("tl.settings.service",["tl.service","tl.settings.resource",function(e,t){var r=function(){};return r.prototype.status=function(e,r){return t.status({},e,r)},r.prototype.config=function(e,r){return t.config({},e,r)},new r}]),angular.module("tl").service("tl.table",["tl.table.resource","tl.table.service",function(e,t){this.resource=e,this.service=t}]),angular.module("tl").factory("tl.table.resource",["tl.resource",function(e){var t="/table/:id";return e(t,{id:"@id"},{})}]),angular.module("tl").service("tl.table.service",["tl.service","tl.table.resource",function(e,t){var r=e.extend(t);return new r}]),angular.module("tl").constant("TRACK_EVENTS",{UserVerifiedPhoneNumber:"TLUserPhoneVerified",UserUpdatedProfilePicture:"TLUserUpdatedProfilePicture",UserCompletedProfile:"TLUserCompletedProfile",CityViewed:"TLCityViewed",CityFeaturedViewed:"TLCityFeaturedViewed",CityTonightViewed:"TLCityTonightViewed",CityThisWeekViewed:"TLCityThisWeekViewed",CityApplied:"TLCityApplied",CityShared:"TLCityShared",VenueViewed:"TLVenueViewed",VenueInfoViewed:"TLVenueInfoViewed",VenueContactViewed:"TLVenueContactViewed",VenueMapViewed:"TLVenueMapViewed",VenueAppliedForAccess:"TLVenueAppliedForAccess",EventViewed:"TLEventViewed",BookingAddBottlesViewed:"TLBookingAddBottlesViewed",BookingInfoViewed:"TLBookingInfoViewed",BookingReviewViewed:"TLBookingReviewViewed",BookingTermsViewed:"TLBookingTermsViewed",BookingComplete:"TLBookingComplete",BookingReservationComplete:"TLBookingReservationComplete",BookingPromoterComplete:"TLBookingPromoterComplete",BookingFailed:"TLBookingFailed",BookingReservationFailed:"TLBookingReservationFailed",BookingAddedToPassbook:"TLBookingAddedToPassbook",BookingInquiryViewed:"TLBookingInquiryViewed",BookingInquirySubmitted:"TLBookingInquirySubmitted",BookingJoinPending:"TLBookingJoinPending",BookingJoinAccepted:"TLBookingJoinAccepted",BookingJoinCodeSent:"TLBookingJoinCodeSent",BookingReviewSubmitted:"TLBookingReviewSubmitted",ReferralEntered:"TLReferralEntered",ReferralSentFB:"TLReferralSentFB",ReferralSentTW:"TLReferralSentTW",ReferralSentSMS:"TLReferralSentSMS",ReferralSentEmail:"TLReferralSentEmail",PaymentAdded:"TLPaymentAdded",PaymentUpdated:"TLPaymentUpdated",CodeRedeemed:"TLPromoCodeRedeemed",RewardViewed:"TLRewardViewed",RewardRedeemed:"TLRewardRedeemed",AboutBlogViewed:"TLAboutBlogViewed",AboutFacebookViewed:"TLAboutFacebookViewed",AboutTwitterViewed:"TLAboutTwitterViewed",AboutWebsiteViewed:"TLAboutWebsiteViewed",EasterEggAccountProfilePicture:"TLEasterEggAccountProfilePicture"}),angular.module("tl").service("tl.track",["tl.track.resource","tl.track.service",function(e,t){this.resource=e,this.service=t}]),angular.module("tl").factory("tl.track.resource",["tl.resource",function(e){var t="/track/:id";return e(t,{id:"@id"},{})}]),angular.module("tl").service("tl.track.service",["tl.service","tl.track.resource","TRACK_EVENTS","tl.config",function(e,t,r,o){var n=e.extend(t);return n.prototype.trackingEvents=function(){return r},n.prototype.send=function(e,r){var n={event:e,data:r,client:{os:o.CLIENT,version:o.VERSION,device:window.navigator?window.navigator.userAgent:null}};return o.SUB_CLIENT&&(n.client.os=n.client.os+("-"+o.SUB_CLIENT)),t.save({},n)},new n}]),angular.module("tl").service("tl.user",["tl.user.resource","tl.user.service",function(e,t){this.resource=e,this.service=t}]),angular.module("tl").factory("tl.user.resource",["tl.resource",function(e){"use strict";var t="/user/:id";return e(t,{id:"@id"},{me:{method:"GET",url:"/me"},updateMe:{method:"PUT",url:"/me"},search:{method:"GET",url:"/user/search",isArray:!0},push:{method:"POST",url:"/notify/push",isArray:!1},listBookings:{method:"GET",url:t+"/booking",isArray:!0},updatePreferredCity:{method:"PUT",url:"/user/city"},requestVerificationCode:{method:"GET",url:"/user/verify/:id"},requestVerificationCodeForCurrentUser:{method:"GET",url:"/user/verify"},verifyPhoneNumber:{method:"PUT",url:"/user/verify/:id"},verifyPhoneNumberForCurrentUser:{method:"PUT",url:"/user/verify"},listPaymentProfiles:{method:"GET",url:"/user/:id/paymentProfiles",isArray:!0},listReferrals:{method:"GET",url:"/user/:id/referral",isArray:!0},listPromos:{method:"GET",url:"/user/:id/promo",isArray:!0},listTasks:{method:"GET",url:"/user/:id/task",isArray:!0},listQuestions:{method:"GET",url:"/user/:id/question",isArray:!0},listAnswers:{method:"GET",url:"/user/:id/answer",isArray:!0},listNotifications:{method:"GET",url:"/notify/:id",isArray:!0},listHighPriority:{method:"GET",url:"/user/priority",isArray:!0},addCredit:{method:"POST",url:"/user/:id/credit"},findByReferral:{method:"GET",url:"/referral/:code"},getReferralStats:{method:"GET",url:"/user/:id/referral/stats"},listVenues:{method:"GET",url:"/user/:id/venue",isArray:!0},favorite:{method:"POST",url:"/user/:id/favorite",isArray:!1},unfavorite:{method:"DELETE",url:"/user/:id/favorite/:favoriteId",isArray:!1}})}]),UserService.prototype.unfavorite=function(e,t,r,o){return User.unfavorite({id:e,favoriteId:t},r,o)},angular.module("tl").service("tl.user.service",["$timeout","tl.storage","tl.keychain","tl.ee","tl.user.resource","tl.service",function(e,t,r,o,n,i){"use strict";var u="tl_user",s={USER_UPDATED:"tl.user.updated"},l=i.extend(n);return l.prototype.currentUser=function(){return r.authToken()?t.get(u):null},l.prototype.EVENTS=function(){return s},l.prototype.setCurrentUser=function(r){return e(function(){o.emit(s.USER_UPDATED,r)}),t.set(u,r)},l.prototype.saveCurrentUser=function(e){for(var t=this.currentUser()||{},r=Object.keys(e),o=0;o<r.length;o++){var n=r[o],i=e[n];t[n]=i}this.setCurrentUser(t)},l.prototype.me=function(e,t){var r=this,o=n.me().$promise;return o.then(function(t){r.saveCurrentUser(t),e&&e(t)},t),o},l.prototype.updateMe=function(e,t,r){var o=this;return n.updateMe({},e).$promise.then(function(e){o.saveCurrentUser(e),t&&t(e)},r)},l.prototype.updatePreferredCity=function(e,t,r){var o=this,i={city:e};return n.updatePreferredCity({},i).$promise.then(function(e){o.saveCurrentUser(e),t&&t(e)},r)},l.prototype.requestVerificationCode=function(e,t,r){return n.requestVerificationCode({id:e},t,r)},l.prototype.requestVerificationCodeForCurrentUser=function(e,t){return n.requestVerificationCodeForCurrentUser({},e,t)},l.prototype.verifyPhoneNumber=function(e,t,r,o){var i=this,u={id:e,verificationCode:t};return n.verifyPhoneNumber({},u).$promise.then(function(e){return i.saveCurrentUser(e),r&&r(e),e},o)},l.prototype.verifyPhoneNumberForCurrentUser=function(e,t,r){var o=this,i={verificationCode:e};return n.verifyPhoneNumber({},i).$promise.then(function(e){return o.saveCurrentUser(e),t&&t(e),e},r)},l.prototype.listPaymentProfiles=function(e,t,r){return n.listPaymentProfiles({id:e},t,r)},l.prototype.listReferrals=function(e,t,r){return n.listReferrals({id:e},t,r)},l.prototype.listBookings=function(e,t,r){return n.listBookings({id:e},t,r)},l.prototype.listPromos=function(e,t,r){return n.listPromos({id:e},t,r)},l.prototype.listTasks=function(e,t,r){return n.listTasks({id:e},t,r)},l.prototype.listNotifications=function(e,t,r){return n.listNotifications({id:e},t,r)},l.prototype.listQuestions=function(e,t,r,o){return n.listQuestions({id:e,type:t},r,o)},l.prototype.listAnswers=function(e,t,r){return n.listAnswers({id:e},t,r)},l.prototype.listHighPriority=function(e,t,r,o,i){return n.listHighPriority({hours:e||24,priority:t||7,city:r},o,i)},l.prototype.addCredit=function(e,t,r,o,i){return n.addCredit({id:e},{amount:t,campaign:r},o,i)},l.prototype.findByReferral=function(e,t,r){return n.findByReferral({code:e},t,r)},l.prototype.getReferralStats=function(e,t,r){return n.getReferralStats({id:e},t,r)},l.prototype.listVenues=function(e,t,r){return n.listVenues({id:e},t,r)},l.prototype.favorite=function(e,t,r,o,i){return n.favorite({id:e},{venueId:t,eventId:r},o,i)},l.prototype.unfavorite=function(e,t,r,o){return n.unfavorite({id:e,favoriteId:t},r,o)},new l}]),angular.module("tl").service("tl.venue",["tl.venue.resource","tl.venue.service",function(e,t){this.resource=e,this.service=t}]),angular.module("tl").factory("tl.venue.resource",["tl.resource",function(e){var t="/venue/:id";return e(t,{id:"@id",itemId:"@itemId",imageId:"@imageId",cityId:"@cityId"},{listForCity:{method:"GET",url:"/city/:cityId/venue",isArray:!0},listCityFeatured:{method:"GET",url:"/city/:cityId/venue/featured",isArray:!0},listCityTonight:{method:"GET",url:"/city/:cityId/venue/tonight",isArray:!0},schedule:{method:"GET",url:t+"/schedule"},updateSchedule:{method:"PUT",url:t+"/schedule"},listInventory:{method:"GET",url:t+"/inventory",isArray:!1},listInventoryAdmin:{method:"GET",url:t+"/inventory/admin",isArray:!1},readInventory:{method:"GET",url:t+"/inventory/:tableId",isArray:!1},addInventory:{method:"POST",url:t+"/inventory",isArray:!1},updateInventory:{method:"PUT",url:t+"/inventory/:tableId",isArray:!1},listEvents:{method:"GET",url:t+"/event",isArray:!0},addEvent:{method:"POST",url:"/event",isArray:!1},listItems:{method:"GET",url:t+"/item",isArray:!0},addItem:{method:"POST",url:t+"/item"},updateItem:{method:"PUT",url:t+"/item/:itemId"},deleteItem:{method:"DELETE",url:t+"/item/:itemId"},listStaff:{method:"GET",url:t+"/user",isArray:!0},addStaff:{method:"POST",url:t+"/user",isArray:!0},updateStaff:{method:"PUT",url:t+"/user/:userId",isArray:!0},removeStaff:{method:"DELETE",url:t+"/user/:userId",isArray:!0},listBookings:{method:"GET",url:t+"/booking",isArray:!0}})
}]),angular.module("tl").service("tl.venue.service",["tl.service","tl.venue.resource",function(e,t){var r=e.extend(t);return r.prototype.listForCity=function(e,r,o){return t.listForCity({cityId:e},r,o)},r.prototype.listCityFeatured=function(e,r,o){return t.listCityFeatured({cityId:e},r,o)},r.prototype.listCityTonight=function(e,r,o){return t.listCityTonight({cityId:e},r,o)},r.prototype.listInventory=function(e,r,o,n,i,u){return t.listInventory({id:e,start:r,end:o,ticket:n},i,u)},r.prototype.listItems=function(e,r,o){return t.listItems({id:e},r,o)},r.prototype.listBookings=function(e,r,o){return t.listBookings(e,r,o)},new r}]);