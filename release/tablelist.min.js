angular.module("tl",["ngResource","ngWebsocket"]).provider("TablelistSdk",function(){function e(e){var r=d[e];if(!r)throw new Error("Enviroment : "+e+" is not valid");c.ENV=e,c.ENV_DEV="development"===e,c.ENV_PROD="production"===e,c.ENV_LOCAL="local"===e,c.ENV_TEST="test"===e,c.API=r}function r(e){c.SUB_CLIENT=e}function t(e){c.VERSION=e}function i(e){c.useAuthHeader=e||!1}var o=window.TL_ENV||"production",n=window.TL_CLIENT||"web",s="development"===o,u="production"===o,a="local"===o,l="test"===o,d={production:"https://api.tablelist.com",development:"https://api-dev.tablelist.com",local:"http://localhost:3000",test:"https://api-dev.tablelist.com"},c={ENV:o,CLIENT:n,SUB_CLIENT:null,ENV_DEV:s,ENV_PROD:u,ENV_LOCAL:a,ENV_TEST:l,API:d[o],useAuthHeader:!1,setSubclient:r,setVersion:t};return{setEnv:e,setSubclient:r,setVersion:t,setUseAuthHeader:i,$get:function(){return c}}}).service("tl.config",["TablelistSdk",function(e){return e}]),angular.module("tl").factory("tl.resource",["$resource","tl.http",function(e,r){"use strict";function t(e){return r.apiUrl(e)}function i(e){return e}function o(e){for(var r=n(),i=Object.keys(e),o=0;o<i.length;o++){var s=i[o];r[s]=e[s]}for(var u=Object.keys(r),a=0;a<u.length;a++){var l=u[a],d=r[l];d.url&&(d.url=t(d.url))}return r}function n(e){return{update:{method:"PUT",url:e},listImages:{method:"GET",url:e+"/image",isArray:!0},addImage:{method:"POST",url:e+"/image",isArray:!0},deleteImage:{method:"DELETE",url:e+"/image/:imageId",isArray:!0},setPrimaryImage:{method:"PUT",url:e+"/image/:imageId",isArray:!0}}}function s(r,t,i,o){var n=e(t,i,o);return n.ENDPOINT=r,n.URL=t,n}return function(e,r,n){var u=t(e),a=i(r),l=o(n);return s(e,u,a,l)}}]),angular.module("tl").factory("tl.service",["tl.http","tl.keychain",function(e,r){"use strict";var t=function(e){this.resource=e},i=function(e){for(var r=function(){t.call(this,e)},i=t.prototype,o=Object.keys(i),n=0;n<o.length;n++){var s=o[n];"constructor"!==s&&(r.prototype[s]=i[s])}return r},o=100,n="-created";return t.prototype.create=function(e,r,t){return this.resource.save({},e,r,t)},t.prototype.read=function(e,r,t){return this.resource.get({id:e},r,t)},t.prototype.update=function(e,r,t,i){return this.resource.update({id:e},r,t,i)},t.prototype.delete=function(e,r,t){return this.resource.delete({id:e},r,t)},t.prototype.list=function(e,r,t,i){return this.resource.query({sort:r||n,limit:e||o},t,i)},t.prototype.query=function(e,r,t,i,s){var u=this.buildQueryString(e);return u?this.resource.query({query:u,sort:t||n,limit:r||o},i,s):null},t.prototype.totals=function(e,r,t,i){var o=this.buildQueryString(e);return o?this.resource.query({total:!0,query:o,sort:r||n},t,i):null},t.prototype.buildQueryString=function(e){try{return JSON.stringify(e)}catch(r){return null}},t.prototype.listImages=function(e,r,t){return this.resource.listImages({id:e},r,t)},t.prototype.addImage=function(e,r,t,i){return r.id=e,this.resource.addImage(r,t,i)},t.prototype.deleteImage=function(e,r,t,i){return this.resource.deleteImage({id:e,imageId:r},t,i)},t.prototype.setPrimaryImage=function(e,r,t,i){return this.resource.setPrimaryImage({id:e,imageId:r},t,i)},t.prototype.exportUrl=function(e,t){var i=this.resource.ENDPOINT,o=this.resource.ENDPOINT.indexOf(":");o>-1&&(i=i.substring(0,o));var n=this.resource.URL.substring(0,this.resource.URL.lastIndexOf(":")-1);return n+="?query="+encodeURIComponent(JSON.stringify(e)),n+="&sort="+t,n+="&admin="+!0,n+="&csv="+!0,n+="&auth="+r.authToken()},{extend:i,common:t}}]),angular.module("tl").factory("tl.cookie",["tl.config","tl.storage",function(e,r){var t=".tablelist.com",i=function(){};return i.prototype.get=function(e){var t=r.get(e),i=t?t.cookie:null,o=decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null;return i||o},i.prototype.set=function(i,o,n,s,u,a){if(!o)return this.remove(i,s,u);if(r.set(i,{cookie:o}),!i||/^(?:expires|max\-age|path|domain|secure)$/i.test(i))return!1;s||(s="/"),n||(n=1/0),u||(u=t),e.ENV_PROD&&(a=!0);var l="";if(n)switch(n.constructor){case Number:l=1/0===n?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+n;break;case String:l="; expires="+n;break;case Date:l="; expires="+n.toUTCString()}var d=encodeURIComponent(i)+"="+encodeURIComponent(o)+l+(u?"; domain="+u:"")+(s?"; path="+s:"")+(a?"; secure":"");return document.cookie=d,!0},i.prototype.remove=function(e,i,o){return o||(o=t),r.remove(e),e&&this.exists(e)?(document.cookie=encodeURIComponent(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(o?"; domain="+o:"")+(i?"; path="+i:""),!0):!1},i.prototype.exists=function(e){return r.exists(e)||new RegExp("(?:^|;\\s*)"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)},new i}]),angular.module("tl").factory("tl.ee",["$rootScope",function(e){var r=function(){};return r.prototype.on=function(r,t){return e.$on(r,t)},r.prototype.emit=function(r,t,i,o){return e.$emit(r,t,i,o)},new r}]),angular.module("tl").factory("tl.facebook",["tl.config",function(e){var r=["public_profile","email","user_friends"],t=function(){};return t.prototype.login=function(e){try{return FB.login(function(r){if(r&&r.authResponse){var t=r.authResponse.accessToken;e(null,t)}else e(r)},{scope:r})}catch(t){return!1}},t.prototype.events=function(){try{return FB.AppEvents.EventNames}catch(e){return{}}},t.prototype.logEvent=function(){if(e.ENV_PROD)try{return FB.AppEvents.logEvent.apply(this,arguments)}catch(r){return!1}},t.prototype.logPurchase=function(){if(e.ENV_PROD)try{return FB.AppEvents.logPurchase.apply(this,arguments)}catch(r){return!1}},new t}]),angular.module("tl").factory("tlHTTPInterceptor",["tl.config","tl.keychain","$rootScope","$q",function(e,r,t,i){"use strict";return{request:function(t){t.headers=t.headers||{};var i=r.authToken(),o=t.url.indexOf(e.API)>=0,n=t.url.indexOf("?")>=0;if(o&&!n&&(t.url=t.url+="?"),o&&i&&(e.useAuthHeader?t.headers["x-access-token"]=i:t.url=t.url+"&auth="+i),o&&!i){var s=r.prospectToken();t.url=t.url+"&prospect="+s}if(o&&e.CLIENT){var u=e.CLIENT,a=e.SUB_CLIENT;a&&(u=u+"-"+a),t.url=t.url+"&client="+u}if(o&&e.VERSION){var l=e.VERSION;t.url=t.url+"&version="+l}return t.url=t.url.replace("?&","?"),t},responseError:function(e){return 401===e.status&&t.$emit("unauthorized"),i.reject(e)}}}]).config(["$httpProvider",function(e){e.interceptors.push("tlHTTPInterceptor")}]).factory("tl.http",["$http","tl.keychain","tl.config",function(e,r,t){var i=function(){};return i.prototype.get=function(r,t){return e.get(this.apiUrl(r,t))},i.prototype.post=function(r,t,i){return e.post(this.apiUrl(r),t,i)},i.prototype.put=function(r,t,i){return e.put(this.apiUrl(r),t,i)},i.prototype.delete=function(r,t){return e.delete(this.apiUrl(r,t))},i.prototype.upload=function(r,t,i){return e.post(this.apiUrl(r,t),i,{headers:{"Content-Type":void 0},transformRequest:angular.identity})},i.prototype.apiUrl=function(e,r){r=r||{},"/"!==e.slice(0,1)&&(e="/"+e);for(var i=[],o=Object.keys(r),n=0;n<o.length;n++){var s=o[n],u=r[s],a=encodeURIComponent(s)+"="+encodeURIComponent(u);i.push(a)}var l=t.API+e;return i.length>0&&(l+="?"+i.join("&")),l},new i}]),angular.module("tl").factory("tl.keychain",["tl.cookie","tl.utils","tl.config",function(e,r,t){"use strict";var i=t.ENV_PROD?"":"_dev",o="tl_auth"+i,n="tl_prospect"+i,s=null,u=null,a=function(){};return a.prototype.authToken=function(){return s||function(){return s=e.get(o)}()},a.prototype.setAuthToken=function(r){return s=r||null,e.set(o,r)},a.prototype.prospectToken=function(){var t=u||function(){return u=e.get(n)}();return t||(t=r.guid(16,"-"),this.setProspectToken(t)),t},a.prototype.setProspectToken=function(r){return u=r||null,e.set(n,r)},new a}]),angular.module("tl").factory("tl.query",["tl.config","$location",function(e,r){var t=function(){};return t.prototype.params=function(){return r.search()||{}},t.prototype.subdomain=function(){return window.location.hostname.split(".")[0]},t.prototype.get=function(e){return this.params()[e]},t.prototype.set=function(e,t){var i=this.params();i[e]=t,r.search(i)},new t}]),angular.module("tl").factory("tl.session",[function(){var e={},r=function(){};return r.prototype.get=function(r){var t=null;try{var i=sessionStorage.getItem(r);t=JSON.parse(i)}catch(o){t=e[r]}return t},r.prototype.set=function(r,t){if(t){var i=null;try{var o=JSON.stringify(t);i=sessionStorage.setItem(r,o)}catch(n){e[r]=t,i=!0}return i}this.remove(r)},r.prototype.remove=function(r){var t=null;try{t=sessionStorage.removeItem(r)}catch(i){delete e[r],t=!0}return t},r.prototype.exists=function(r){var t=null;try{t=null!==this.get(r)&&void 0!==this.get(r)}catch(i){t=e[r]?!0:!1}return t},r.prototype.clear=function(){var r=null;try{r=sessionStorage.clear()}catch(t){e={},r=!0}return r},new r}]),angular.module("tl").factory("tl.socket",["$websocket","tl.http","tl.keychain",function(e,r,t){var i=5e3,o=200;return function(n,s,u){s=s||function(){},u=u||function(){};var a=[],l="ping",d="pong",c=null,p=null;this.connect=function(){this.ws=c=e.$new({url:this.socketUrl(n),reconnect:!0,reconnectInterval:250}),c.$on("$open",function(){p=window.setInterval(function(){c.$$ws.send(l)},i)}),c.$on("$message",function(e){e!==d&&(a.unshift(e),s(e),a.length>=o&&a.pop())}),c.$on("$close",function(){window.clearInterval(p)})},this.events=function(){return a},this.isConnected=function(){return c.$status()===c.$OPEN},this.close=function(){return c.$close()},this.socketUrl=function(e){var i=t.authToken(),o=t.prospectToken(),n={};o&&(n.prospect=o),i&&(n.auth=i);var s=r.apiUrl(e,n);return s.replace("http","ws")}}}]),angular.module("tl").factory("tl.storage",[function(){"use strcit";var e={},r=function(){};return r.prototype.get=function(r){var t=null;try{var i=localStorage.getItem(r);t=JSON.parse(i)}catch(o){t=e[r]}return t},r.prototype.set=function(r,t){if(t){var i=null;try{var o=JSON.stringify(t);i=localStorage.setItem(r,o)}catch(n){e[r]=t,i=!0}return i}this.remove(r)},r.prototype.remove=function(r){var t=null;try{t=localStorage.removeItem(r)}catch(i){delete e[r],t=!0}return t},r.prototype.exists=function(r){var t=null;try{t=null!==this.get(r)&&void 0!==this.get(r)}catch(i){t=e[r]?!0:!1}return t},r.prototype.clear=function(){var r=null;try{r=localStorage.clear()}catch(t){e={},r=!0}return r},new r}]),angular.module("tl").factory("tl.utils",[function(){var e=function(){};return e.prototype.noop=function(){},e.prototype.slugify=function(e){return e.trim().replace(/\s/gi,"-").replace(/('|\.)/gi,"").toLowerCase()},e.prototype.digits=function(e){return e?(e+="",e.replace(/\D/g,"").trim()):null},e.prototype.guid=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},e.prototype.csv=function(e){var r="data:text/csv;charset=utf-8,";r+=e.map(function(e){return e.map(function(e){return e&&e.replace?e.replace(/,/gi,""):e}).join(",")}).join("\n"),window.open(encodeURI(r))},new e}]),angular.module("tl").service("tl.affiliatesale",["tl.affiliatesale.resource","tl.affiliatesale.service",function(e,r){this.resource=e,this.service=r}]),angular.module("tl").factory("tl.affiliatesale.resource",["tl.resource",function(e){"use strict";var r="/affiliate-sale";return e(r,{id:"@id"},{list:{method:"GET",url:r,isArray:!0}})}]),angular.module("tl").service("tl.affiliatesale.service",["tl.affiliatesale.resource","tl.service",function(e,r){"use strict";var t=r.extend(e);return t.prototype.list=function(r){if(!r)throw new Error("options is required");return r.query=r.query?JSON.stringify(r.query):r.query,e.list(r).$promise},new t}]),angular.module("tl").service("tl.affiliate",["tl.affiliate.resource","tl.affiliate.service",function(e,r){this.resource=e,this.service=r}]),angular.module("tl").factory("tl.affiliate.resource",["tl.resource",function(e){"use strict";var r="/affiliate/:id";return e(r,{id:"@id"},{getById:{method:"GET",url:r,isArray:!1},getPayoutStructuresById:{method:"GET",url:r+"/payoutstructure",isArray:!0},create:{method:"POST",url:"affiliate",isArray:!1},update:{method:"PATCH",url:r,isArray:!1},list:{method:"GET",url:"affiliate",isArray:!0},listSales:{method:"GET",url:r+"/sale",isArray:!0},getSalesTotal:{method:"GET",url:r+"/sale/total"},getSalesLeaderboard:{method:"GET",url:r+"/leaderboard",isArray:!0},getPayoutPeriod:{method:"GET",url:r+"/payout-period",isArray:!0},getPromoCode:{method:"GET",url:r+"/promo",isArray:!0},getTrackers:{method:"GET",url:r+"/tracker",isArray:!0}})}]),angular.module("tl").service("tl.affiliate.service",["tl.affiliate.resource","tl.service","$http","tl.http",function(e,r,t,i){"use strict";var o=r.extend(e);return o.prototype.getById=function(r){if(!r)throw new Error("options is required");if(!r.id)throw new Error("options.id is required");return e.getById(r).$promise},o.prototype.getPayoutStructuresById=function(r){if(!r)throw new Error("options is required");if(!r.id)throw new Error("options.id is required");return e.getPayoutStructuresById(r).$promise},o.prototype.list=function(r){if(!r)throw new Error("options is required");return e.list(r).$promise},o.prototype.create=function(r){if(!r)throw new Error("options is required");return e.create({},r).$promise},o.prototype.update=function(r){if(!r)throw new Error("options is required");if(!r.id)throw new Error("options.id is required");var t=r.id;return delete r.id,e.update({id:t},r).$promise},o.prototype.listSales=function(r){if(!r)throw new Error("options is required");if(!r.id)throw new Error("options.id is required");return e.listSales(r).$promise},o.prototype.getSalesTotal=function(r){if(!r)throw new Error("options is required");if(!r.id)throw new Error("options.id is required");return e.getSalesTotal(r).$promise},o.prototype.listSalesAsCsv=function(e){if(!e)throw new Error("options is required");if(!e.id)throw new Error("options.id is required");var r=e.id;return delete e.id,t.get(i.apiUrl("/affiliate/"+r+"/sale"),{params:e,data:"",headers:{"Content-Type":"text/csv"}})},o.prototype.getSalesLeaderboard=function(r){if(!r)throw new Error("options is required");if(!r.id)throw new Error("options.id is required");return e.getSalesLeaderboard(r).$promise},o.prototype.getPayoutPeriod=function(r){if(!r)throw new Error("options is required");if(!r.id)throw new Error("options.id is required");return e.getPayoutPeriod(r).$promise},o.prototype.getPromoCode=function(r){if(!r)throw new Error("options is required");if(!r.id)throw new Error("options.id is required");return e.getPromoCode(r).$promise},o.prototype.listTrackers=function(r){if(!r)throw new Error("options is required");if(!r.id)throw new Error("options.id is required");return e.getTrackers(r).$promise},new o}]),angular.module("tl").service("tl.affiliatepayout",["tl.affiliatepayout.resource","tl.affiliatepayout.service",function(e,r){this.resource=e,this.service=r}]),angular.module("tl").factory("tl.affiliatepayout.resource",["tl.resource",function(e){"use strict";var r="/affiliate-payout";return e(r,{id:"@id"},{list:{method:"GET",url:r,isArray:!0}})}]),angular.module("tl").service("tl.affiliatepayout.service",["tl.affiliatepayout.resource","tl.service",function(e,r){"use strict";var t=r.extend(e);return t.prototype.list=function(r){if(!r)throw new Error("options is required");return r.query=r.query?JSON.stringify(r.query):r.query,e.list(r).$promise},new t}]),angular.module("tl").service("tl.ambassador ",["tl.ambassador.resource","tl.ambassador.service",function(e,r){this.resource=e,this.service=r}]),angular.module("tl").factory("tl.ambassador.resource",["tl.resource",function(e){var r="/ambassador";return e(r,{id:"@id"},{getAll:{method:"GET",url:"ambassador",isArray:!0}})}]),angular.module("tl").service("tl.ambassador.service",["tl.service","tl.ambassador.resource",function(e,r){var t=e.extend(r);return t.prototype.getAll=function(){return r.getAll()},new t}]),angular.module("tl").service("tl.answer",["tl.answer.resource","tl.answer.service",function(e,r){this.resource=e,this.service=r}]),angular.module("tl").factory("tl.answer.resource",["tl.resource",function(e){var r="/answer";return e(r,{},{})}]),angular.module("tl").service("tl.answer.service",["tl.service","tl.answer.resource",function(e,r){var t=e.extend(r);return new t}]),angular.module("tl").service("tl.auth",["tl.auth.resource","tl.auth.service",function(e,r){this.resource=e,this.service=r}]),angular.module("tl").factory("tl.auth.resource",["tl.resource",function(e){"use strict";var r="/auth";return e(r,{},{register:{method:"POST",url:r+"/register",isArray:!1},login:{method:"POST",url:r+"/login",isArray:!1},loginFacebook:{method:"POST",url:r+"/facebook",isArray:!1},forgotPassword:{method:"POST",url:r+"/forgot",isArray:!1},resetPassword:{method:"POST",url:r+"/reset",isArray:!1}})}]),angular.module("tl").service("tl.auth.service",["tl.auth.resource","tl.keychain","tl.user.service","tl.facebook",function(e,r,t,i){"use strict";var o=function(){};return o.prototype.authToken=function(){return r.authToken()},o.prototype.setAuthToken=function(e){return r.setAuthToken(e)},o.prototype.register=function(r,i,o){if(i=i||function(){},!r)throw new Error("options is required");if(!r.email)throw new Error("options.email is required");if(!r.password)throw new Error("options.password is required");if(!r.firstName)throw new Error("options.firstName is required");if(!r.lastName)throw new Error("options.lastName is required");var n=this;return n.setAuthToken(null),t.setCurrentUser(null),e.register({},r).$promise.then(function(e){n.setAuthToken(e.token),t.setCurrentUser(e.user),i(e)},o)},o.prototype.login=function(r,i,o,n){o=o||function(){};var s=this;return s.setAuthToken(null),t.setCurrentUser(null),e.login({},{email:r,password:i}).$promise.then(function(e){s.setAuthToken(e.token),t.setCurrentUser(e.user),o(e)},n)},o.prototype.loginWithFacebook=function(r,o){r=r||function(){};var n=this;n.setAuthToken(null),t.setCurrentUser(null),i.login(function(i,s){return i?o(i):e.loginFacebook({},{facebookToken:s}).$promise.then(function(e){n.setAuthToken(e.token),t.setCurrentUser(e.user),r(e)},o)})},o.prototype.logout=function(){return this.setAuthToken(null),t.setCurrentUser(null),r.setProspectToken(null),!0},o.prototype.forgotPassword=function(r,t,i){return e.forgotPassword({},{email:r},t,i)},o.prototype.resetPassword=function(r,t,i,o){return e.resetPassword({},{resetToken:r,password:t},i,o)},new o}]),angular.module("tl").service("tl.booking",["tl.booking.resource","tl.booking.service",function(e,r){this.resource=e,this.service=r}]),angular.module("tl").factory("tl.booking.resource",["tl.resource",function(e){"use strict";var r="/booking/:id";return e(r,{id:"@id"},{read:{method:"GET",url:r},create:{method:"POST",url:"booking"},complete:{method:"POST",url:r+"/complete"},"void":{method:"POST",url:r+"/void"},refund:{method:"POST",url:r+"/refund"},join:{method:"POST",url:"booking/join"},decline:{method:"POST",url:r+"/decline"},updateBookingUser:{method:"PUT",url:r+"/users/:userId"},listOutgoingPayment:{method:"GET",url:r+"/outgoing-payment",isArray:!0},readSplitTable:{method:"GET",url:"booking/split/:code"},listTerms:{method:"GET",url:"booking/:id/terms",isArray:!0},addCondition:{method:"POST",url:"booking/:id/condition"},accept:{method:"POST",url:"booking/:id/accept"},createOutgoingPayment:{method:"POST",url:r+"/outgoing-payment"},refundBookingUser:{method:"POST",url:r+"/user/:userId/refund"},listBookingTickets:{method:"GET",url:r+"/ticket",isArray:!0}})}]),angular.module("tl").service("tl.booking.service",["tl.booking.resource","tl.service",function(e,r){"use strict";var t=100,i="-created",o=r.extend(e);return o.prototype.read=function(r){if(!r)throw new Error("options is required");if(!r.id)throw new Error("options.id is required");return e.read(r).$promise},o.prototype.query=function(r){if(!r)throw new Error("options is required");var o={},n=this;return o.sort=r.sort||i,o.limit=r.limit||t,o.admin=r.admin||!1,o.select=r.select||o.select,delete r.sort,delete r.limit,delete r.admin,delete r.select,o.query=r,o.query=n.buildQueryString(o.query),e.query(o).$promise},o.prototype.create=function(r){if(!r)throw new Error("options is required");return e.create({},r).$promise},o.prototype.complete=function(r){if(!r)throw new Error("options is required");if(!r.id)throw new Error("options.id is required");var t=r.id;return delete r.id,e.complete({id:t},r).$promise},o.prototype.void=function(r,t,i,o){return e.void({id:r},t,i,o)},o.prototype.refund=function(r,t,i,o,n){return e.refund({},{id:r,money:t,reason:i},o,n)},o.prototype.join=function(r,t,i){return e.join({},{splitCode:r},t,i)},o.prototype.decline=function(r,t,i,o){return e.decline({id:r},{userId:t},i,o)},o.prototype.updateBookingUser=function(r,t,i,o,n){return e.updateBookingUser({id:r,userId:t},i,o,n)},o.prototype.listOutgoingPayment=function(r,t,i){return e.listOutgoingPayment({id:r},t,i)},o.prototype.createOutgoingPayment=function(r){if(!r)throw new Error("options is required");if(!r.id)throw new Error("options.id is required");var t=r.id;return delete r.id,e.createOutgoingPayment({id:t},r).$promise},o.prototype.readSplitTable=function(r,t,i){return e.readSplitTable({code:r},{},t,i)},o.prototype.listTerms=function(r){if(!r)throw new Error("options is required");if(!r.id)throw new Error("options.id is required");return e.listTerms(r).$promise},o.prototype.addCondition=function(r){if(!r)throw new Error("options is required");if(!r.id)throw new Error("options.id is required");if(!r.condition)throw new Error("options.condition is required");var t=r.id;return delete r.id,e.addCondition({id:t},r).$promise},o.prototype.accept=function(r){if(!r)throw new Error("options is required");if(!r.id)throw new Error("options.id is required");if(!r.userId)throw new Error("options.userId is required");if(!r.paymentProfileId)throw new Error("options.paymentProfileId is required");var t=r.id;return delete r.id,e.accept({id:t},r).$promise},o.prototype.refundBookingUser=function(r){if(!r)throw new Error("options is required");if(!r.id)throw new Error("options.id is required");if(!r.userId)throw new Error("options.userId is required");if(!r.type)throw new Error("options.type is required");var t=r.id;delete r.id;var i=r.userId;return delete r.userId,e.refundBookingUser({id:t,userId:i},r).$promise},o.prototype.listBookingTickets=function(r){if(!r)throw new Error("options is required");if(!r.id)throw new Error("options.id is required");var t=r.id;return delete r.id,e.listBookingTickets({id:t},r).$promise},o.prototype.update=function(r){if(!r)throw new Error("options is required");if(!r.id)throw new Error("options.id is required");var t=r.id;return delete r.id,e.update({id:t},r).$promise},new o}]),angular.module("tl").service("tl.campaign",["tl.campaign.resource","tl.campaign.service",function(e,r){this.resource=e,this.service=r}]),angular.module("tl").factory("tl.campaign.resource",["tl.resource",function(e){var r="/campaign/:id";return e(r,{id:"@id"},{})}]),angular.module("tl").service("tl.campaign.service",["tl.storage","tl.campaign.resource","tl.service",function(e,r,t){var i=t.extend(r);return i.prototype.listInternal=function(){return r.list({internal:!0}).$promise},new i}]),angular.module("tl").service("tl.city",["tl.city.resource","tl.city.service",function(e,r){this.resource=e,this.service=r}]),angular.module("tl").factory("tl.city.resource",["tl.resource",function(e){return e("/city/:id",{id:"@id"},{})}]),angular.module("tl").service("tl.city.service",["tl.service","tl.city.resource",function(e,r){var t=e.extend(r);return new t}]),angular.module("tl").service("tl.event",["tl.event.resource","tl.event.service",function(e,r){this.resource=e,this.service=r}]),angular.module("tl").factory("tl.event.resource",["tl.resource",function(e){var r="/event/:id";return e(r,{id:"@id",imageId:"@imageId"},{update:{method:"PATCH",url:r,isArray:!1},list:{method:"GET",url:"/event",isArray:!0},listForCity:{method:"GET",url:"/city/:cityId/event",isArray:!0},addStaff:{method:"POST",url:r+"/staff",isArray:!1},updateStaff:{method:"PUT",url:r+"/staff/:staffId",isArray:!1},deleteStaff:{method:"DELETE",url:r+"/staff/:staffId",isArray:!1}})}]),angular.module("tl").service("tl.event.service",["tl.service","tl.event.resource",function(e,r){var t=e.extend(r);return t.prototype.list=function(e){if(!e)throw new Error("options is required");return e.query=e.query?JSON.stringify(e.query):e.query,r.list(e).$promise},t.prototype.read=function(e){if(!e)throw new Error("options is required");if(!e.id)throw new Error("options.id is required");return r.get(e).$promise},t.prototype.create=function(e){if(!e)throw new Error("options is required");return r.save({},e).$promise},t.prototype.update=function(e){if(!e)throw new Error("options is required");if(!e.id)throw new Error("options.id is required");return r.update({id:e.id},e).$promise},t.prototype.listForCity=function(e,t,i){return r.listForCity({cityId:e},t,i)},t.prototype.listCityTonight=function(e,t,i){return r.listCityTonight({cityId:e},t,i)},t.prototype.addStaff=function(e,t,i,o){return r.addStaff({id:e},{userId:t},i,o)},t.prototype.updateStaff=function(e,t,i,o,n){return r.updateStaff({id:e,staffId:t},i,o,n)},t.prototype.deleteStaff=function(e,t,i,o){return r.deleteStaff({id:e,staffId:t},i,o)},new t}]),angular.module("tl").service("tl.image",["tl.image.resource","tl.image.service",function(e,r){this.resource=e,this.service=r}]),angular.module("tl").factory("tl.image.resource",["tl.resource",function(e){var r="/image";return e(r,{},{})}]),angular.module("tl").service("tl.image.service",["tl.service","tl.image.resource","tl.http","$q",function(e,r,t,i){var o=e.extend(r);return o.prototype.upload=function(e,r){var o=i.defer(),n=new FormData;n.append("image",e);var s=16e6;return e.size>s&&o.reject("File cannot be greater than 4mb"),t.upload("/image",r,n).success(function(e,r,t,i){o.resolve(e,r,t,i)}).error(function(e,r,t,i){o.reject(e,r,t,i)}),o.promise},new o}]),angular.module("tl").service("tl.inventory",["tl.inventory.resource","tl.inventory.service",function(e,r){this.resource=e,this.service=r}]),angular.module("tl").factory("tl.inventory.resource",["tl.resource",function(e){"use strict";var r="/inventory/:id";return e(r,{id:"@id"},{listForVenue:{method:"GET",url:"/inventory",isArray:!0}})}]),angular.module("tl").service("tl.inventory.service",["tl.service","tl.inventory.resource",function(e,r){"use strict";var t=e.extend(r);return t.prototype.listForVenue=function(e){if(!e)throw new Error("options is required");if(!e.venue)throw new Error("options.venue is required");return e.start=e.start||moment().startOf("month").format("YYYY-MM-DD"),e.end=e.end||moment().endOf("month").format("YYYY-MM-DD"),r.listForVenue(e).$promise},new t}]),angular.module("tl").service("tl.inquiry",["tl.inquiry.resource","tl.inquiry.service",function(e,r){this.resource=e,this.service=r}]),angular.module("tl").factory("tl.inquiry.resource",["tl.resource",function(e){var r="/inquiry/:id";return e(r,{id:"@id"},{approve:{method:"POST",url:r+"/approve",isArray:!1},decline:{method:"POST",url:r+"/decline",isArray:!1}})}]),angular.module("tl").service("tl.inquiry.service",["tl.service","tl.inquiry.resource",function(e,r){"use strict";var t=100,i="-created",o=e.extend(r);return o.prototype.list=function(e){if(!e)throw new Error("options is required");return e.sort=e.sort||i,e.limit=e.limit||t,r.query(e).$promise},o.prototype.approve=function(e){if(!e)throw new Error("options is required");if(!e.inquiryId)throw new Error("options.inquiryId is required");return e.id=e.inquiryId,delete e.inquiryId,r.approve(e).$promise},o.prototype.decline=function(e){if(!e)throw new Error("options is required");if(!e.inquiryId)throw new Error("options.inquiryId is required");return e.id=e.inquiryId,delete e.inquiryId,r.decline(e).$promise},new o}]),angular.module("tl").service("tl.inventory-tier-config",["tl.inventory.resource","tl.inventory.service",function(e,r){this.resource=e,this.service=r}]),angular.module("tl").factory("tl.inventory-tier-config.resource",["tl.resource",function(e){"use strict";var r="/inventory-tier-config/:id";return e(r,{id:"@id"},{list:{method:"GET",url:"/inventory-tier-config",isArray:!0},create:{method:"POST",url:"/inventory-tier-config",isArray:!1}})}]),angular.module("tl").service("tl.inventory-tier-config.service",["tl.service","tl.inventory-tier-config.resource",function(e,r){"use strict";var t=e.extend(r);return t.prototype.create=function(e){if(!e)throw new Error("options is required");return r.save({},e).$promise},t.prototype.list=function(e){if(!e)throw new Error("options is required");return r.list(e).$promise},new t}]),angular.module("tl").service("tl.invoice",["tl.invoice.resource","tl.invoice.service",function(e,r){this.resource=e,this.service=r}]),angular.module("tl").factory("tl.invoice.resource",["tl.resource",function(e){var r="/invoice/:id";return e(r,{id:"@id"},{update:{method:"PUT",url:r,isArray:!1},readPdf:{method:"GET",url:r+"/pdf",isArray:!1},createPdf:{method:"POST",url:r+"/pdf",isArray:!1}})}]),angular.module("tl").service("tl.invoice.service",["tl.service","tl.invoice.resource",function(e,r){var t=e.extend(r);return t.prototype.readPdf=function(e){return r.readPdf({id:e})},t.prototype.createPdf=function(e){return r.createPdf({id:e})},new t}]),angular.module("tl").service("tl.item",["tl.item.resource","tl.item.service",function(e,r){this.resource=e,this.service=r}]),angular.module("tl").factory("tl.item.resource",["tl.resource",function(e){var r="/item/:id";return e(r,{id:"@id"},{list:{method:"GET",url:"/item",isArray:!0}})}]),angular.module("tl").service("tl.item.service",["tl.service","tl.item.resource",function(e,r){var t=e.extend(r);return t.prototype.list=function(e){if(!e)throw new Error("options is required");return e.query=e.query?JSON.stringify(e.query):e.query,r.list(e).$promise},new t}]),angular.module("tl").service("tl.metric",["tl.metric.resource","tl.metric.service",function(e,r){this.resource=e,this.service=r}]),angular.module("tl").factory("tl.metric.resource",["tl.resource",function(e){var r="/metric/:id";return e(r,{id:"@id"},{available:{method:"GET",url:"/metric/available",isArray:!0},queryMetrics:{method:"GET",url:"/metric"}})}]),angular.module("tl").service("tl.metric.service",["tl.service","tl.metric.resource",function(e,r){var t=e.extend(r);return t.prototype.availableMetrics=function(e,t){return r.available({},e,t)},t.prototype.queryMetrics=function(e,t,i,o,n,s){arguments.length<6&&(s=n,n=o,o=null);var u={metric:e,period:t,start:i[0].getTime(),end:i[1].getTime()};if(o)for(var a=Object.keys(o),l=0;l<a.length;l++){var d=a[l];u[d]=o[d]}return r.queryMetrics(u,n,s)},new t}]),angular.module("tl").service("tl.notify",["tl.metric.resource","tl.metric.service",function(e,r){this.resource=e,this.service=r}]),angular.module("tl").factory("tl.notify.resource",["tl.resource",function(e){var r="/notify/adminapp";return e(r,{id:"@id"},{sendAdminApp:{method:"POST",url:r,isArray:!1}})}]),angular.module("tl").service("tl.notify.service",["tl.service","tl.notify.resource",function(e,r){var t=e.extend(r);return t.prototype.sendAdminApp=function(){return r.sendAdminApp().$promise},new t}]),angular.module("tl").service("tl.outgoingPayment",["tl.outgoingPayment.resource","tl.outgoingPayment.service",function(e,r){this.resource=e,this.service=r}]),angular.module("tl").factory("tl.outgoingPayment.resource",["tl.resource",function(e){"use strict";var r="/outgoing-payment/:id";return e(r,{id:"@id"},{listTransaction:{method:"GET",url:r+"/transaction",isArray:!0},listAuthorization:{method:"GET",url:r+"/authorization",isArray:!0}})}]),angular.module("tl").service("tl.outgoingPayment.service",["tl.outgoingPayment.resource","tl.service",function(e,r){"use strict";var t=r.extend(e);return t.prototype.listTransaction=function(r,t,i){return e.listTransaction({id:r},t,i)},t.prototype.listAuthorization=function(r,t,i){return e.listAuthorization({id:r},t,i)},new t}]),angular.module("tl").service("tl.payment",["tl.payment.resource","tl.payment.service",function(e,r){this.resource=e,this.service=r
}]),angular.module("tl").factory("tl.payment.resource",["tl.resource",function(e){var r="/paymentProfile/:id";return e(r,{id:"@id"},{})}]),angular.module("tl").service("tl.payment.service",["tl.service","tl.payment.resource","tl.utils",function(e,r,t){"use strict";var i=e.extend(r);return i.prototype.addPaymentProfile=function(e){var r={cardholderName:e.name,cardNumber:t.digits(e.number),cardExpMonth:t.digits(e.month),cardExpYear:t.digits(e.year),cardCvv:t.digits(e.cvv),cardZip:t.digits(e.zip)};return this.create(r).$promise},i.prototype.updatePaymentProfile=function(e){var r=e.id;if(!r)throw"An existing profile is required. Missing options.id";var i={cardholderName:e.name,cardNumber:t.digits(e.number),cardExpMonth:t.digits(e.month),cardExpYear:t.digits(e.year),cardCvv:t.digits(e.cvv),cardZip:t.digits(e.zip)};return this.update(r,i).$promise},i.prototype.addProfile=function(e,r,i,o,n,s,u,a,l,d,c){console.log("DEPRECATED - use .addPaymentProfile");var p={cardholderName:e,cardNumber:t.digits(r),cardExpMonth:t.digits(i),cardExpYear:t.digits(o),cardCvv:t.digits(n),cardZip:t.digits(l),address:{address:s,city:u,state:a}};return this.create(p,d,c)},i.prototype.updateProfile=function(e,r,i,o,n,s,u,a,l,d,c,p){if(console.log("DEPRECATED - use .updatePaymentProfile"),!e)return this.addProfile(r,i,o,n,s,u,a,l,d,c,p);var f={cardholderName:r,cardNumber:t.digits(i),cardExpMonth:t.digits(o),cardExpYear:t.digits(n),cardCvv:t.digits(s),cardZip:t.digits(d),address:{address:u,city:a,state:l}};return this.update(e,f,c,p)},new i}]),angular.module("tl").service("tl.permission",["tl.permission.resource","tl.permission.service",function(e,r){this.resource=e,this.service=r}]),angular.module("tl").factory("tl.permission.resource",["tl.resource",function(e){var r="/permission/:id";return e(r,{id:"@id"},{listVenuePermissions:{method:"GET",url:"/permission/venue"}})}]),angular.module("tl").service("tl.permission.service",["tl.permission.resource","tl.service",function(e,r){var t=r.extend(e);return t.prototype.listVenuePermissions=function(r){return e.listVenuePermissions(r).$promise},new t}]),angular.module("tl").service("tl.promo",["tl.promo.resource","tl.promo.service",function(e,r){this.resource=e,this.service=r}]),angular.module("tl").factory("tl.promo.resource",["tl.resource",function(e){var r="/promo/:id";return e(r,{id:"@id"},{redeem:{method:"POST",url:"/promo/redeem"}})}]),angular.module("tl").service("tl.promo.service",["tl.storage","tl.promo.resource","tl.service",function(e,r,t){var i=t.extend(r);return i.prototype.redeem=function(e){return r.redeem({code:e})},new i}]),angular.module("tl").service("tl.prospect",["tl.prospect.resource","tl.prospect.service",function(e,r){this.resource=e,this.service=r}]),angular.module("tl").factory("tl.prospect.resource",["tl.resource",function(e){var r="/prospect/:id";return e(r,{id:"@id"},{})}]),angular.module("tl").service("tl.prospect.service",["tl.service","tl.prospect.resource",function(e,r){var t=e.extend(r);return t.prototype.updateProspect=function(e,t,i){return delete e._id,delete e.id,r.update({},e,t,i)},new t}]),angular.module("tl").service("tl.question",["tl.question.resource","tl.question.service",function(e,r){this.resource=e,this.service=r}]),angular.module("tl").factory("tl.question.resource",["tl.resource",function(e){var r="/question";return e(r,{id:"@id"},{get:{method:"GET",url:r+"/:id"},listAnswers:{method:"GET",url:r+"/:id/answers",isArray:!0},listTotalsForAnswers:{method:"GET",url:r+"/:id/answers/totals",isArray:!0}})}]),angular.module("tl").service("tl.question.service",["tl.question.resource","tl.service",function(e,r){var t=r.extend(e);return t.prototype.listAnswers=function(r){return e.listAnswers({id:r})},t.prototype.listTotalsForAnswers=function(r){return e.listTotalsForAnswers({id:r})},new t}]),angular.module("tl").service("tl.report",["tl.report.resource","tl.report.service",function(e,r){this.resource=e,this.service=r}]),angular.module("tl").factory("tl.report.resource",["tl.resource",function(e){var r="/report/:id";return e(r,{id:"@id"},{reports:{method:"GET",url:"/report-type"},download:{method:"GET",url:r+"/download"}})}]),angular.module("tl").service("tl.report.service",["tl.service","tl.report.resource",function(e,r){var t=e.extend(r);return t.prototype.reports=function(e,t){return r.reports({},e,t)},t.prototype.listReports=function(e,t,i){return r.query({report:e},t,i)},t.prototype.download=function(e,t,i){return r.download({id:e},t,i)},new t}]),angular.module("tl").service("tl.review",["tl.review.resource","tl.review.service",function(e,r){this.resource=e,this.service=r}]),angular.module("tl").factory("tl.review.resource",["tl.resource",function(e){var r="/review/:id";return e(r,{id:"@id"},{})}]),angular.module("tl").service("tl.review.service",["tl.service","tl.review.resource",function(e,r){var t=e.extend(r);return new t}]),angular.module("tl").service("tl.reward",["tl.reward.resource","tl.reward.service",function(e,r){this.resource=e,this.service=r}]),angular.module("tl").factory("tl.reward.resource",["tl.resource",function(e){var r="/reward/:id";return e(r,{id:"@id"},{})}]),angular.module("tl").service("tl.reward.service",["tl.service","tl.reward.resource",function(e,r){var t=e.extend(r);return new t}]),angular.module("tl").service("tl.sale",["tl.sale.resource","tl.sale.service",function(e,r){this.resource=e,this.service=r}]),angular.module("tl").factory("tl.sale.resource",["tl.resource",function(e){var r="/sale";return e(r,{id:"@id"},{read:{method:"GET",url:r+"/:id",isArray:!1},update:{method:"PUT",url:r+"/:id",isArray:!1},list:{method:"GET",url:r,isArray:!0}})}]),angular.module("tl").service("tl.sale.service",["tl.service","tl.sale.resource",function(e,r){var t=e.extend(r);return t.prototype.read=function(e){if(!e)throw new Error("options is required");if(!e.id)throw new Error("options.id is required");return r.read(e).$promise},t.prototype.update=function(e){if(!e)throw new Error("options is required");if(!e.id)throw new Error("options.id is required");var t=e.id;return delete e.id,r.update({id:t},e).$promise},t.prototype.list=function(e){if(!e)throw new Error("options is required");return e.query=e.query?JSON.stringify(e.query):e.query,r.list(e).$promise},new t}]),angular.module("tl").service("tl.schedule",["tl.schedule.resource","tl.schedule.service",function(e,r){this.resource=e,this.service=r}]),angular.module("tl").factory("tl.schedule.resource",["tl.resource",function(e){var r="/schedule/:id";return e(r,{id:"@id"},{})}]),angular.module("tl").service("tl.schedule.service",["tl.service","tl.schedule.resource",function(e,r){var t=e.extend(r);return new t}]),angular.module("tl").service("tl.settings",["tl.settings.resource","tl.settings.service",function(e,r){this.resource=e,this.service=r}]),angular.module("tl").factory("tl.settings.resource",["tl.resource",function(e){var r="/config";return e(r,{},{status:{method:"GET",url:"/status",isArray:!1},config:{method:"GET",url:"/config",isArray:!1}})}]),angular.module("tl").service("tl.settings.service",["tl.service","tl.settings.resource",function(e,r){var t=function(){};return t.prototype.status=function(e,t){return r.status({},e,t)},t.prototype.config=function(e,t){return r.config({},e,t)},new t}]),angular.module("tl").service("tl.support",["tl.support.service","tl.support.message","tl.support.task",function(e,r,t){this.service=e,this.message=r,this.task=t}]),angular.module("tl").service("tl.support.service",["tl.socket","tl.support.message",function(e,r){"use strict";var t=function(){};return t.prototype.listClientMessages=function(e){return e=e||{},r.resource.list(e).$promise},t.prototype.sendInboundMessage=function(e,t){return t=t||{},r.resource.sendInboundMessage({},{text:e,data:t.data,city:t.city}).$promise},t.prototype.listenForClientMessages=function(r){return new e("/support/message/client",r)},new t}]),angular.module("tl").service("tl.table",["tl.table.resource","tl.table.service",function(e,r){this.resource=e,this.service=r}]),angular.module("tl").factory("tl.table.resource",["tl.resource",function(e){var r="/table/:id";return e(r,{id:"@id"},{})}]),angular.module("tl").service("tl.table.service",["tl.service","tl.table.resource",function(e,r){var t=e.extend(r);return new t}]),angular.module("tl").service("tl.tag",["tl.tag.resource","tl.tag.service",function(e,r){this.resource=e,this.service=r}]),angular.module("tl").factory("tl.tag.resource",["tl.resource",function(e){var r="/tag";return e(r,{},{list:{method:"GET",url:r,isArray:!0}})}]),angular.module("tl").service("tl.tag.service",["tl.service","tl.tag.resource",function(e,r){"use strict";var t=e.extend(r);return t.prototype.list=function(e){return r.list(e).$promise},new t}]),angular.module("tl").service("tl.tracker",["tl.tracker.resource","tl.tracker.service",function(e,r){this.resource=e,this.service=r}]),angular.module("tl").factory("tl.tracker.resource",["tl.resource",function(e){var r="/tracker";return e(r,{},{create:{method:"POST",url:r,isArray:!1}})}]),angular.module("tl").service("tl.tracker.service",["tl.service","tl.tracker.resource",function(e,r){"use strict";var t=e.extend(r);return t.prototype.create=function(e){return r.save({},e).$promise},new t}]),angular.module("tl").constant("TRACK_EVENTS",{UserVerifiedPhoneNumber:"TLUserPhoneVerified",UserUpdatedProfilePicture:"TLUserUpdatedProfilePicture",UserCompletedProfile:"TLUserCompletedProfile",CityViewed:"TLCityViewed",CityFeaturedViewed:"TLCityFeaturedViewed",CityTonightViewed:"TLCityTonightViewed",CityThisWeekViewed:"TLCityThisWeekViewed",CityApplied:"TLCityApplied",CityShared:"TLCityShared",VenueViewed:"TLVenueViewed",VenueInfoViewed:"TLVenueInfoViewed",VenueContactViewed:"TLVenueContactViewed",VenueMapViewed:"TLVenueMapViewed",VenueAppliedForAccess:"TLVenueAppliedForAccess",EventViewed:"TLEventViewed",BookingAddBottlesViewed:"TLBookingAddBottlesViewed",BookingInfoViewed:"TLBookingInfoViewed",BookingReviewViewed:"TLBookingReviewViewed",BookingTermsViewed:"TLBookingTermsViewed",BookingComplete:"TLBookingComplete",BookingReservationComplete:"TLBookingReservationComplete",BookingPromoterComplete:"TLBookingPromoterComplete",BookingFailed:"TLBookingFailed",BookingReservationFailed:"TLBookingReservationFailed",BookingAddedToPassbook:"TLBookingAddedToPassbook",BookingInquiryViewed:"TLBookingInquiryViewed",BookingInquirySubmitted:"TLBookingInquirySubmitted",BookingJoinPending:"TLBookingJoinPending",BookingJoinAccepted:"TLBookingJoinAccepted",BookingJoinCodeSent:"TLBookingJoinCodeSent",BookingReviewSubmitted:"TLBookingReviewSubmitted",ReferralEntered:"TLReferralEntered",ReferralSentFB:"TLReferralSentFB",ReferralSentTW:"TLReferralSentTW",ReferralSentSMS:"TLReferralSentSMS",ReferralSentEmail:"TLReferralSentEmail",PaymentAdded:"TLPaymentAdded",PaymentUpdated:"TLPaymentUpdated",CodeRedeemed:"TLPromoCodeRedeemed",RewardViewed:"TLRewardViewed",RewardRedeemed:"TLRewardRedeemed",AboutBlogViewed:"TLAboutBlogViewed",AboutFacebookViewed:"TLAboutFacebookViewed",AboutTwitterViewed:"TLAboutTwitterViewed",AboutWebsiteViewed:"TLAboutWebsiteViewed",EasterEggAccountProfilePicture:"TLEasterEggAccountProfilePicture"}),angular.module("tl").service("tl.track",["tl.track.resource","tl.track.service",function(e,r){this.resource=e,this.service=r}]),angular.module("tl").factory("tl.track.resource",["tl.resource",function(e){var r="/track/:id";return e(r,{id:"@id"},{funnel:{method:"POST",url:"/track/funnel",isArray:!0},listPossibleEvents:{method:"GET",url:"/track/events",isArray:!0}})}]),angular.module("tl").service("tl.track.service",["tl.service","tl.track.resource","TRACK_EVENTS","tl.config",function(e,r,t,i){var o=null,n=e.extend(r);return n.prototype.trackingEvents=function(){return t},n.prototype.send=function(e,t){var n={event:e,data:t,client:{os:i.CLIENT,version:i.VERSION,device:window.navigator?window.navigator.userAgent:null}};return i.SUB_CLIENT&&(n.client.os=n.client.os+("-"+i.SUB_CLIENT)),o&&(n.data=n.data||{},n.data.affiliate=o),r.save({},n)},n.prototype.setAffiliate=function(e){o=e||null},n.prototype.listPossibleEvents=function(e,t){return r.listPossibleEvents({},e,t).$promise},n.prototype.funnel=function(e,t,i,o){return r.funnel({},{events:e,start:t.start.getTime(),end:t.end.getTime(),data:t.data,client:t.client},i,o).$promise},new n}]),angular.module("tl").service("tl.user",["tl.user.resource","tl.user.service",function(e,r){this.resource=e,this.service=r}]),angular.module("tl").factory("tl.user.resource",["tl.resource",function(e){"use strict";var r="/user/:id";return e(r,{id:"@id"},{list:{method:"GET",url:"/user",isArray:!0},me:{method:"GET",url:"/me"},updateMe:{method:"PUT",url:"/me"},search:{method:"GET",url:"/user/search",isArray:!0},push:{method:"POST",url:"/notify/push",isArray:!1},listBookings:{method:"GET",url:r+"/booking",isArray:!0},updatePreferredCity:{method:"PUT",url:"/user/city"},requestVerificationCode:{method:"GET",url:"/user/verify/:id"},requestVerificationCodeForCurrentUser:{method:"GET",url:"/user/verify"},verifyPhoneNumber:{method:"PUT",url:"/user/verify/:id"},verifyPhoneNumberForCurrentUser:{method:"PUT",url:"/user/verify"},listPaymentProfiles:{method:"GET",url:r+"/paymentProfiles",isArray:!0},listReferrals:{method:"GET",url:r+"/referral",isArray:!0},listPromos:{method:"GET",url:r+"/promo",isArray:!0},listTasks:{method:"GET",url:r+"/task",isArray:!0},listQuestions:{method:"GET",url:r+"/question",isArray:!0},listAnswers:{method:"GET",url:r+"/answer",isArray:!0},listNotifications:{method:"GET",url:"/notify/:id",isArray:!0},listHighPriority:{method:"GET",url:"/user/priority",isArray:!0},addCredit:{method:"POST",url:r+"/credit"},findByReferral:{method:"GET",url:"/referral/:code"},getReferralStats:{method:"GET",url:r+"/referral/stats"},listVenues:{method:"GET",url:r+"/venue",isArray:!0},favorite:{method:"POST",url:r+"/favorite",isArray:!1},unfavorite:{method:"DELETE",url:r+"/favorite/:favoriteId",isArray:!1},listFavorites:{method:"GET",url:r+"/favorite",isArray:!0},markAffiliate:{method:"POST",url:r+"/affiliate",isArray:!1},listAffiliates:{method:"GET",url:"user/:id/affiliate",isArray:!0},access:{method:"GET",url:"user/:id/access",isArray:!0}})}]),angular.module("tl").service("tl.user.service",["$timeout","tl.storage","tl.keychain","tl.ee","tl.user.resource","tl.service",function(e,r,t,i,o,n){"use strict";var s="tl_user",u={USER_UPDATED:"tl.user.updated"},a=n.extend(o);return a.prototype.list=function(e){if(!e)throw new Error("options is required");return e.query=e.query?JSON.stringify(e.query):e.query,o.list(e).$promise},a.prototype.currentUser=function(){return t.authToken()?r.get(s):null},a.prototype.EVENTS=function(){return u},a.prototype.setCurrentUser=function(t){return e(function(){i.emit(u.USER_UPDATED,t)}),r.set(s,t)},a.prototype.saveCurrentUser=function(e){for(var r=this.currentUser()||{},t=Object.keys(e),i=0;i<t.length;i++){var o=t[i],n=e[o];r[o]=n}this.setCurrentUser(r)},a.prototype.me=function(e,r){var t=this,i=o.me().$promise;return i.then(function(r){t.saveCurrentUser(r),e&&e(r)},r),i},a.prototype.updateMe=function(e,r,t){var i=this;return o.updateMe({},e).$promise.then(function(e){i.saveCurrentUser(e),r&&r(e)},t)},a.prototype.updatePreferredCity=function(e,r,t){var i=this,n={city:e};return o.updatePreferredCity({},n).$promise.then(function(e){i.saveCurrentUser(e),r&&r(e)},t)},a.prototype.requestVerificationCode=function(e,r,t){return o.requestVerificationCode({id:e},r,t)},a.prototype.requestVerificationCodeForCurrentUser=function(e,r){return o.requestVerificationCodeForCurrentUser({},e,r)},a.prototype.verifyPhoneNumber=function(e,r,t,i){var n=this,s={id:e,verificationCode:r};return o.verifyPhoneNumber({},s).$promise.then(function(e){return n.saveCurrentUser(e),t&&t(e),e},i)},a.prototype.verifyPhoneNumberForCurrentUser=function(e,r,t){var i=this,n={verificationCode:e};return o.verifyPhoneNumber({},n).$promise.then(function(e){return i.saveCurrentUser(e),r&&r(e),e},t)},a.prototype.listPaymentProfiles=function(e,r,t){return o.listPaymentProfiles({id:e},r,t)},a.prototype.listReferrals=function(e,r,t){return o.listReferrals({id:e},r,t)},a.prototype.listBookings=function(e){if(!e)throw new Error("options is required");if(!e.id)throw new Error("options.id is required");return o.listBookings(e).$promise},a.prototype.listPromos=function(e,r,t){return o.listPromos({id:e},r,t)},a.prototype.listTasks=function(e,r,t){return o.listTasks({id:e},r,t)},a.prototype.listNotifications=function(e,r,t){return o.listNotifications({id:e},r,t)},a.prototype.listQuestions=function(e,r,t,i){return o.listQuestions({id:e,type:r},t,i)},a.prototype.listAnswers=function(e,r,t){return o.listAnswers({id:e},r,t)},a.prototype.listHighPriority=function(e,r,t,i,n){return o.listHighPriority({hours:e||24,priority:r||7,city:t},i,n)},a.prototype.addCredit=function(e,r,t,i,n){return o.addCredit({id:e},{amount:r,campaign:t},i,n)},a.prototype.findByReferral=function(e,r,t){return o.findByReferral({code:e},r,t)},a.prototype.getReferralStats=function(e,r,t){return o.getReferralStats({id:e},r,t)},a.prototype.search=function(e){if(!e)throw new Error("options is required");if(!e.query)throw new Error("options.query is required");return o.search(e).$promise},a.prototype.listVenues=function(e){if(!e)throw new Error("options is required");if(!e.userId)throw new Error("options.userId is required");return e.id=e.userId,delete e.userId,o.listVenues(e).$promise},a.prototype.favorite=function(e){if(!e)throw new Error("options is required");if(!e.userId)throw new Error("options.userId is required");var r=e.userId;return delete e.userId,o.favorite({id:r},e).$promise},a.prototype.unfavorite=function(e){if(!e)throw new Error("options is required");if(!e.userId)throw new Error("options.userId is required");if(!e.favoriteId)throw new Error("options.favoriteId is required");var r=e.userId;delete e.userId;var t=e.favoriteId;return delete e.favoriteId,o.unfavorite({id:r,favoriteId:t},e).$promise},a.prototype.listFavorites=function(e){if(!e)throw new Error("options is required");if(!e.userId)throw new Error("options.userId is required");return e.id=e.userId,delete e.userId,o.listFavorites(e).$promise},a.prototype.markAffiliate=function(e,r){if(!e)throw new Error("userId is required");if(!r)throw new Error("options is required");if(!r.name)throw new Error("options.name is required");return o.markAffiliate({id:e},r).$promise},a.prototype.listAffiliates=function(e){if(!e)throw new Error("options is required");if(!e.userId)throw new Error("options.userId is required");return e.id=e.userId,delete e.userId,o.listAffiliates(e).$promise},a.prototype.access=function(e){if(!e)throw new Error("options is required");if(!e.userId)throw new Error("options.userId is required");return e.id=e.userId,delete e.userId,o.access(e).$promise},new a}]),angular.module("tl").service("tl.venue",["tl.venue.resource","tl.venue.service",function(e,r){this.resource=e,this.service=r}]),angular.module("tl").factory("tl.venue.resource",["tl.resource",function(e){var r="/venue/:id";return e(r,{id:"@id",itemId:"@itemId",imageId:"@imageId",cityId:"@cityId"},{list:{method:"GET",url:"/venue",isArray:!0},listForCity:{method:"GET",url:"/city/:cityId/venue",isArray:!0},listCityFeatured:{method:"GET",url:"/city/:cityId/venue/featured",isArray:!0},listCityTonight:{method:"GET",url:"/city/:cityId/venue/tonight",isArray:!0,cache:!0},schedule:{method:"GET",url:r+"/schedule"},updateSchedule:{method:"PUT",url:r+"/schedule"},listInventory:{method:"GET",url:r+"/inventory",isArray:!1},listInventoryAdmin:{method:"GET",url:r+"/inventory/admin",isArray:!1},readInventory:{method:"GET",url:r+"/inventory/:tableId",isArray:!1},addInventory:{method:"POST",url:r+"/inventory",isArray:!1},updateInventory:{method:"PUT",url:r+"/inventory/:tableId",isArray:!1},listInventoryTierConfigs:{method:"GET",url:r+"/inventory-tier-config",isArray:!0},listEvents:{method:"GET",url:r+"/event",isArray:!0},addEvent:{method:"POST",url:"/event",isArray:!1},listItems:{method:"GET",url:r+"/item",isArray:!0},addItem:{method:"POST",url:r+"/item"},updateItem:{method:"PUT",url:r+"/item/:itemId"},deleteItem:{method:"DELETE",url:r+"/item/:itemId"},listStaff:{method:"GET",url:r+"/staff",isArray:!0},readStaff:{method:"GET",url:r+"/staff/:staffId",isArray:!1},createStaff:{method:"POST",url:r+"/staff",isArray:!1},updateStaff:{method:"PUT",url:r+"/staff/:staffId",isArray:!1},deleteStaff:{method:"DELETE",url:r+"/staff/:staffId",isArray:!1},listBookings:{method:"GET",url:r+"/booking",isArray:!0},listReviews:{method:"GET",url:r+"/review",isArray:!0},addStaffPermission:{method:"POST",url:r+"/staff/:staffId/permission",isArray:!0},removeStaffPermission:{method:"DELETE",url:r+"/staff/:staffId/permission/:permission",isArray:!1},listStaffPermissions:{method:"GET",url:r+"/staff/:staffId/permission",isArray:!0}})}]),angular.module("tl").service("tl.venue.service",["tl.service","tl.venue.resource",function(e,r){"use strict";var t=e.extend(r);return t.prototype.list=function(e){if(!e)throw new Error("options is required");return e.query=e.query?JSON.stringify(e.query):e.query,r.list(e).$promise},t.prototype.read=function(e){if(!e)throw new Error("options is required");if(!e.id)throw new Error("options.id is required");return r.get(e).$promise},t.prototype.create=function(e){if(!e)throw new Error("options is required");return r.save({},e).$promise},t.prototype.update=function(e){if(!e)throw new Error("options is required");if(!e.id)throw new Error("options.id is required");return r.update({id:e.id},e).$promise},t.prototype.listForCity=function(e){if(!e)throw new Error("options.required");if(!e.cityId)throw new Error("options.cityId is required");return r.listForCity(e).$promise},t.prototype.listCityFeatured=function(e){if(!e)throw new Error("options.required");if(!e.cityId)throw new Error("options.cityId is required");return r.listCityFeatured(e).$promise},t.prototype.listCityTonight=function(e){if(!e)throw new Error("options.required");if(!e.cityId)throw new Error("options.cityId is required");return r.listCityTonight(e).$promise},t.prototype.listInventory=function(e){if(!e)throw new Error("options.required");if(!e.id)throw new Error("options.id is required");return e.start=e.start||moment().startOf("month").format("YYYY-MM-DD"),e.end=e.end||moment().endOf("month").format("YYYY-MM-DD"),e.ticket=e.ticket||"false",r.listInventory(e).$promise},t.prototype.listInventoryTierConfigs=function(e){if(!e)throw new Error("options.required");if(!e.id)throw new Error("options.id is required");return e.start=e.start||moment().startOf("month").toDate().getTime(),e.end=e.end||moment().endOf("month").toDate().getTime(),r.listInventoryTierConfigs(e).$promise},t.prototype.addItem=function(e){if(!e)throw new Error("options is required");if(!e.id)throw new Error("options.id is required");var t=e.id;return delete e.id,r.addItem({id:t},e).$promise},t.prototype.listItems=function(e){if(!e)throw new Error("options.required");if(!e.id)throw new Error("options.id is required");return r.listItems(e).$promise},t.prototype.updateItem=function(e){if(!e)throw new Error("options is required");if(!e.id)throw new Error("options.id is required");if(!e.itemId)throw new Error("options.itemId is required");var t=e.id;delete e.id;var i=e.itemId;return delete e.itemId,r.updateItem({id:t,itemId:i},e).$promise},t.prototype.deleteItem=function(e){if(!e)throw new Error("options is required");if(!e.id)throw new Error("options.id is required");if(!e.itemId)throw new Error("options.itemId is required");var t=e.id;delete e.id;var i=e.itemId;return delete e.itemId,r.deleteItem({id:t,itemId:i},e).$promise},t.prototype.listBookings=function(e,t,i){return r.listBookings(e,t,i)},t.prototype.listEvents=function(e){if(!e)throw new Error("options.required");if(!e.id)throw new Error("options.id is required");return r.listEvents(e).$promise},t.prototype.listReviews=function(e){if(!e)throw new Error("options.required");if(!e.id)throw new Error("options.id is required");return r.listReviews(e).$promise},t.prototype.listStaff=function(e){if(!e)throw new Error("options.required");if(!e.id)throw new Error("options.id is required");return r.listStaff(e).$promise},t.prototype.readStaff=function(e){if(!e)throw new Error("options.required");if(!e.id)throw new Error("options.id is required");if(!e.staffId)throw new Error("options.staffId is required");return r.readStaff(e).$promise},t.prototype.createStaff=function(e){if(!e)throw new Error("options.required");if(!e.id)throw new Error("options.id is required");var t=e.id;return delete e.id,r.createStaff({id:t},e).$promise},t.prototype.updateStaff=function(e){if(!e)throw new Error("options.required");if(!e.id)throw new Error("options.id is required");if(!e.staffId)throw new Error("options.staffId is required");if(!e.updates)throw new Error("options.updates is required");var t=e.id;delete e.id;var i=e.staffId;return delete e.staffId,r.updateStaff({id:t,staffId:i},e.updates).$promise},t.prototype.deleteStaff=function(e){if(!e)throw new Error("options.required");if(!e.id)throw new Error("options.id is required");if(!e.staffId)throw new Error("options.staffId is required");var t=e.id;delete e.id;var i=e.staffId;return delete e.staffId,r.deleteStaff({id:t,staffId:i},e).$promise},t.prototype.addStaffPermission=function(e){if(!e)throw new Error("options.required");if(!e.id)throw new Error("options.id is required");if(!e.staffId)throw new Error("options.staffId is required");if(!e.permission)throw new Error("options.permission is required");var t=e.id;delete e.id;var i=e.staffId;return delete e.staffId,r.addStaffPermission({id:t,staffId:i},e).$promise},t.prototype.removeStaffPermission=function(e){if(!e)throw new Error("options.required");if(!e.id)throw new Error("options.id is required");if(!e.staffId)throw new Error("options.staffId is required");if(!e.permission)throw new Error("options.permission is required");return r.removeStaffPermission(e).$promise},t.prototype.listStaffPermissions=function(e){if(!e)throw new Error("options.required");if(!e.id)throw new Error("options.id is required");if(!e.staffId)throw new Error("options.staffId is required");return r.listStaffPermissions(e).$promise},new t}]),angular.module("tl").service("tl.support.message",["tl.support.message.resource","tl.support.message.service",function(e,r){this.resource=e,this.service=r}]),angular.module("tl").factory("tl.support.message.resource",["tl.resource",function(e){var r="/support/message";return e(r,{},{list:{method:"GET",url:r,isArray:!0},sendInboundMessage:{method:"POST",url:r+"/inbound",isArray:!1},sendOutboundMessage:{method:"POST",url:r+"/outbound",isArray:!1},sendInternalMessage:{method:"POST",url:r+"/internal",isArray:!1}})}]),angular.module("tl").service("tl.support.message.service",["tl.service","tl.support.message.resource",function(e,r){"use strict";var t=e.extend(r);return new t}]),angular.module("tl").service("tl.support.task",["tl.support.task.resource","tl.support.task.service",function(e,r){this.resource=e,this.service=r}]),angular.module("tl").factory("tl.support.task.resource",["tl.resource",function(e){var r="/support/task";return e(r,{},{})}]),angular.module("tl").service("tl.support.task.service",["tl.service","tl.support.task.resource",function(e,r){"use strict";var t=e.extend(r);return new t}]);